Реализация методов шумоподавления Реализовать модель аддитивного шума, используя Гауссовскую случайную величину с распределением Модель формирования аддитивного шума для битных значений интенсивностей пикселей изображения можно представить следующим образом: где значение интенсивности компоненты полученной в результате обработки исходной компоненты значение интенсивности, а значение шума на позиции пикселя с координатами Для реализации модели аддитивного шума требуется сгенерировать случайную величину распределенную по нормальному закону. Генерация случайной величины, распределенной по нормальному закону, осуществляется с помощью преобразования Бокса-Мюллера. В результате такого преобразования значения пикселей яркостной компоненты с глубиной бит могут выйти за границы интервала В этом случае результат подвергается дополнительной операции клиппирования которая описывается формулой: если если иначе Исходное изображение имеет вид: Рисунок Исходное изображение В результате формирования аддитивного шума были получены следующие изображения: Рисунок Использование гауссовской случайной величины с распределением Рисунок Использование гауссовской случайной величины с распределением Из полученных изображений можно заметить, что с увеличением параметра усиливается и искажение изображения. Реализовать модель импульсного шума Модель формирования импульсного шума для битных значений интенсивностей описывается следующей формулой: с вероятностью с вероятностью с вероятностью где параметры модели импульсного шума. В результате формирования импульсного шума были получены изображения: Рисунок Модель импульсного шума с параметрами и Рисунок Модель импульсного шума с параметрами и Из полученных изображений становится видно, что импульсный шум более выражен чем аддитивный даже при небольшом значение вероятности, т.к. зашумлённые пиксели принимают крайние значения или Построить графики для модели аддитивного шума и для модели импульсного шума. Критерием оценки искажений, вносимых в изображение, является пиковое отношение сигнал/шум В используемой разрядной сетке значениче вычисляется по формуле: где ширина изображения, высота изображения, значение яркостной компоненты с координатами значение яркостной компоненты в искаженному изображении с координатами Были получены следующие значения для модели аддитивного шума: Рисунок Значения для График имеет вид: Рисунок График для модели аддитивного шума Были получены следующие значения для модели импульсного шума: Рисунок Значения для График имеет вид: Рисунок График для модели импульсного шума По результатам графиков видно, что импульсный шум вносит большие потери в качество картинки даже при малых параметрах. Обработка изображений с Гауссовским шумом Реализовать метод скользящего среднего. В методе скользящего среднего значения весовых коэффициентов постоянны и не зависят от расстояния до центрального пикселя. Все весовые коэффициенты равны единице, в связи с этим выход фильтра рассчитывается по следующей формуле: где радиус фильтра. Фильтр скользящего среднего вносит специфическое размытие в области резких перепадов интенсивностей на изображении. В результате наложения аддитивного шума с параметром и применения фильтра, скользящего среднего с параметром были получены изображения: Рисунок Изображение с аддитивным шумом с параметром Рисунок Изображение, полученное после применения фильтра методом, скользящего среднего при В результате фильтрации изображение получилось немного размытым, но шум все же удалось сгладить, значение тоже подросло. Подобрать размер окна для метода, скользящего среднего, который бы позволил максимизировать значение вычисляемое по оригинальному изображению и зашумленному изображению после фильтрации Рассмотрим модель шума с параметрами Для каждой из них будет рассчитано значение после применения фильтрации методом скользящего среднего с радиусом и В результате работы программы были получены следующие значения: Рисунок Рассчитанные значения для различных и Сравнивая результаты, можно заметить, что максимальное значение достигается при маленьких значениях для малых однако с увеличением шума максимальное значение достигается тоже должно увеличиваться. Реализовать метод Гауссовской фильтрации. Функции расстояния для расчета значений весовых коэффициентов формируется на базе функции Гаусса от двух переменных отсюда и название фильтра): где параметр фильтра, определяющий скорость убывания коэффициентов по мере удаления от позиции центрального пикселя. В процессе выполнения фильтрации входного зашумленного) изображения формируется новое изображение с теми же размерами Каждый пиксель формируется в результате применения некоторого оператора к пикселю и подмножеству соседних с ним пикселей, образующих так называемую апертуру) фильтра: где радиус фильтра, определяющий апертуру, весовые коэффициенты фильтра, коэффициент нормировки, рассчитывающийся как В окрестности контуров резких перепадов) применение линейных фильтров приводит к размытию” контура. Поэтому данный класс фильтров также называют фильтрами размытия в англоязычной литературе В результате наложения аддитивного шума с параметром и после применения фильтра Гаусса были получены изображения: Рисунок Изображение с аддитивным шумом с параметром Рисунок Изображение, полученное после применения фильтра Гаусса После фильтрации опять же получается некоторое размытие картинки, однако шум сглаживается. Построить графики для нескольких фиксированных значений определяемых преподавателем. Для построения графиков будут зафиксированы значения для параметра фильтра) и по пять зависимостей на каждом для каждой сигмы параметра шума)) сигма(параметра фильтра)). Сигму параметр фильтра) взяты: а сигма параметр шума) принимает значения и Таким образом были получены графики: Рисунок График фильтр) для Рисунок График фильтр) для Рисунок График фильтр) для Из полученных при значениях фильтр значения при всех фильтра рассматриваемых шумах и значениях перестают увеличиваться, а при малых шумах даже начинает уже уменьшаться. Подобрать параметр для метода Гауссовской фильтрации, который бы позволил максимизировать значение вычисляемое по оригинальному изображению и зашумленному изображению после фильтрации Необходимо определить лучшие параметры фильтра и сигма) для каждой сигмы параметра шума). Таким образом, при анализе полученных графиков, были получены следующие результаты: Рисунок Лучшие значения при фиксированной шум Как видно из полученных значений чем больше значение шума, тем больше значение при котором максимально. Реализовать метод медианной фильтрации с размерами окон где определяет радиус фильтра Алгоритм медианной фильтрации для пикселя можно представить в виде следующих шагов: формирование одномерного массива из апертуры пикселя взятие медианы одномерного массива Описанный алгоритм применяется для всех пикселей исходного изображения Рассмотрим принципы нахождения медианы на примере произвольного одномерного массива ледует выполнить следующие шаги: произвести сортировку элементов одномерного массива неважно по возрастанию или по убыванию) сохранить в элемент, находящийся в середине отсортированного массива Для апертуры радиуса необходимо взять из отсортированного массива элемент с индексом Изображения с аддитивным шумом и после наложения фильтра: Рисунок Изображение с аддитивным шумом с параметром Рисунок Изображение, полученное после медианной фильтрации с Результатом работы фильтра является очень нечеткое изображение, шум удалось сгладить, тем не менее контуры размыты. Подобрать размер окна для метода медианной фильтрации, который бы позволил максимизировать значение вычисляемое по оригинальному изображению и зашумленному изображению после фильтрации Рассмотрим модель шума с параметрами Для каждой из них будет рассчитано значение после применения медианной фильтрации с радиусом В результате работы программы были получены следующие значения: Рисунок Рассчитанные значения для различных и При зашумленности принимает максимальное значение при В случае большой зашумленности, когда наибольшее значение достигается при Отсюда можно сделать вывод, что чем сильнее шум на изображении, тем больший размер окна следует брать. Проанализировать значения рассчитанные для зашумленных изображений после фильтрации Параметр шума Рисунок Изображение с шумом Рисунок Изображение с применением скользящего среднего Рисунок Изображение с применением фильтра Гаусса Рисунок Изображение с применением медианного фильтра Параметр шума Рисунок Изображение с шумом Рисунок Изображение с применением скользящего среднего Рисунок Изображение с применением фильтра Гаусса Рисунок Изображение с применением медианного фильтра Параметр шума Рисунок Изображение с шумом Рисунок Изображение с применением скользящего среднего Рисунок Изображение с применением фильтра Гаусса Рисунок Изображение с применением медианного фильтра Параметр шума Рисунок Изображение с шумом Рисунок Изображение с применением скользящего среднего Рисунок Изображение с применением фильтра Гаусса Рисунок Изображение с применением медианного фильтра Параметр шума Рисунок Изображение с шумом Рисунок Изображение с применением скользящего среднего Рисунок Изображение с применением фильтра Гаусса Рисунок Изображение с применением медианного фильтра Визуально можно заметить, что метод Гаусса и скользящего среднего эффективнее улучшает изображение. Метод медианной фильтрации даже при слабом шуме заметно ухудшает изображение. Так же у метода медианной фильтрации отсутствует зернистость, как у фильтра Гаусса и скользящего среднего. Произвести анализ полученных значений после применения различных фильтров Рисунок Графики По графикам видно, что для слабозашумлённых изображений лучшей фильтрацией является фильтр Гаусса. Для для данной картинки лучшей фильтрацией является медианный метод, однако визуально для медианного фильтра изображение воспринимается гораздо хуже. Примерно для значения всех фильтров примерно равны. Обработка изображений с импульсным шумом Наложить на исходное изображение импульсный шум в соответствии с моделью. Подготовить несколько вариантов зашумленного изображения, для которых доля искаженных пикселей составит Рисунок Изображение с импульсным шумом с параметрами Рисунок Изображение с импульсным шумом с параметрами Рисунок Изображение с импульсным шумом с параметрами Рисунок Изображение с импульсным шумом с параметрами Вычислить значения по исходному и зашумленным изображениям Значения имеют вид: Рисунок импульсного шума При зашумленности в значение уменьшается в раза по сравнению с зашумленностью в Реализовать метод медианной фильтрации с размерами окон где определяет радиус фильтра Изображения с применением медианного фильтра имеют вид: Рисунок Изображение с применением медианного фильтра для импульсного изображения с параметрами Рисунок Изображение с применением медианного фильтра для импульсного изображения с параметрами Рисунок Изображение с применением медианного фильтра для импульсного изображения с параметрами Рисунок Изображение с применением медианного фильтра для импульсного изображения с параметрами По полученным изображением можно сделать вывод, что изображения получились смазанными, медианная фильтрация позволила полностью избавиться от шума. При большом шуме изображение стало визуально восприимчивым по сравнению с зашумленным. Это связано с тем, что данный метод игнорирует крайние значения интенсивности, которые и принимает пиксель при импульсном шуме. Построить зависимость для всех вариантов зашумленных изображений. Провести визуальное сравнение. Указать искажения, специфические для рассмотренных методов. Выбрать наилучший параметр фильтра для каждого варианта зашумленного изображения По результатам графика видно, что при низкой зашумленности и оптимальными значениями для достижения максимального являются в случае с зашумленностью в оптимальным является при шуме в наилучший результат дает Реализация методов выделения контуров Применение оператора Лапласа и формирование изображения по отклику Рисунок Отклик после первой маски Рисунок Отклик после второй маски В результате были сформированы изображения по отклику: Рисунок Изображение по отклику после первой маски Рисунок Изображения по отклику после второй маски По полученным изображениям можно увидеть разницу в применении масок: например, после использования первой маски пазы на шляпках саморезов белого цвета, а после использования второй пазы на шляпках саморезов черного цвета. Синтез изображения с усилением высоких частот Необходимо синтезировать изображение с усилением высоких частот, используя разность исходного изображения и отклика оператора Лапласа применив маску из следующего рисунка: Рисунок Маска фильтра Лапласа Значение пикселя на позиции х, у) синтезированного изображения вычисляется по следующей формуле: В результаты было синтезировано изображение с усилением высоких частот: Рисунок Синтезированное изображение с усилением высоких частот Необходимо синтезировать изображения, применив маску, для разных значений параметра Параметр изменяется в интервале от до с шагом Результаты синтеза: Рисунок Синтезированное изображение при Рисунок Синтезированное изображение при Рисунок Синтезированное изображение при Рисунок Синтезированное изображение при Рисунок Синтезированное изображение при Рисунок Синтезированное изображение при Синтезированное изображение совпадает с при так как это соответствует маске Лапласа при именно при этом значении достигается максимальный эффект увеличения резкости. При увеличении значения растет яркость изображения. Средние значения яркости Необходимо рассчитать среднее значение яркости для каждого из изображений, полученных в предыдущем пункте: Рисунок Средняя яркость Построение и анализ гистограмм Рисунок Гистограмма исходного изображения Рисунок Гистограмма изображения для Рисунок Гистограмма изображения для Рисунок Гистограмма изображения для Рисунок Гистограмма изображения для Рисунок Гистограмма изображения для Рисунок Гистограмма изображения для По полученным гистограммам отчетливо можно видеть, что, при увеличении уменьшается общее количество пикселей с интенсивностью компоненты и увеличивается крайний правый пик количество пикселей с интенсивностью компоненты равной Это связано с постепенным осветлением изображения все больше компонент пикселей принимают свое максимальное значение. Применение оператора Собеля Необходимо применить оператор Собеля к исходному изображению Оператор Собеля является ключевым во многих алгоритмах анализа контуров изображения. В основе оператора Собеля лежит расчет двух производных: по вертикали и по горизонтали. Соответствующие этим операциям маски фильтров: а) по горизонтали, б) по вертикали Алгоритм применения оператора: Рассчитать значения откликов и используя фильтры с масками Рассчитать величину силы длины) контура по формуле Рассчитать направление градиента по формуле Результат: Рисунок Изображение в результате применения оператора Собеля Формирование изображений для рассмотренных порогов и выбор наилучшего. Рисунок Результат применения оператора Собеля для Рисунок Результат применения оператора Собеля для Рисунок Результат применения оператора Собеля для Рисунок Результат применения оператора Собеля для Рисунок Результат применения оператора Собеля для Рисунок Результат применения оператора Собеля для Рисунок Результат применения оператора Собеля для По сформированным изображениям можно сделать вывод, что наиболее точной бинарной картой является карта с порогом или же при В случае, когда изображения в некоторых местах перегружены белыми пикселями. При порогах и некоторые контуры становятся чётче различимы, а некоторые исчезают вовсе. Карта направлений градиентов Необходимо построить цветную карту направлений градиентов на полученных изображениях по такому правилу: Рисунок Правило соответствия цветов с квадрантами расположения Рисунок Карта направлений градиентов Градационные преобразования на базе опорных точек Синтезировать засвеченное, затемненное, а также сбалансированное изображения и применить к ним градационное преобразование на базе двух опорных точек для повышения качества исходных изображений: Рисунок Сбалансированное изображение Рисунок Преобразование на основе двух опорных точек и сбалансированного изображения Рисунок Затемнённое изображение Рисунок Преобразование на основе двух опорных точек и затемненного изображения Рисунок Засвеченное изображение Рисунок Преобразование на основе двух опорных точек и засвеченного изображения Формирование гистограммы для исходных и полученных изображений Рисунок Гистограмма для сбалансированного изображения до и после преобразования Рисунок Гистограмма для засвеченного изображения до и после преобразования Рисунок Гистограмма для затемненного изображения до и после преобразования По полученным гистограммам можно увидеть, что преобразование не влияет на количество пикселей с крайними значениями компонент относительно других пикселей, но поднимает количество отдаленных от крайних пикселей. Гамма преобразование Рисунок Сбалансированное изображение Рисунок Преобразованное сбалансированного изображения при Рисунок Преобразованное сбалансированного изображения при Рисунок Преобразованное сбалансированного изображения при Рисунок Преобразованное сбалансированного изображения при Рисунок Преобразованное сбалансированного изображения при Рисунок Исходное засвеченное изображение Рисунок Преобразованное засвеченного изображения при Рисунок Преобразованное засвеченного изображения при Рисунок Преобразованное засвеченного изображения при Рисунок Преобразованное засвеченного изображения при Рисунок Преобразованное засвеченного изображения при Рисунок Исходное затемненное изображение Рисунок Преобразованное засвеченного изображения при Рисунок Преобразованное засвеченного изображения при Рисунок Преобразованное засвеченного изображения при Рисунок Преобразованное засвеченного изображения при Рисунок Преобразованное засвеченного изображения при По полученным результатам можно сделать вывод, что при значениях яркость изображения увеличивается, но при уже наоборот уменьшается. Таким образом, для улучшения качества засвеченного изображения нужно брать значения а для затемненного. Гистограммы исходных и полученных после гамма преобразования изображений Рисунок Гистограмма для сбалансированного изображения Рисунок Гистограмма для засвеченного изображения Рисунок Гистограмма для затемненного изображения По полученным данным можно убедиться, что вывод, сделанный в предыдущем пункте, верный. Также можно сказать, что гамма преобразование повышает контрастность изображении. Синтез засвеченного, затемненного, а также сбалансированного изображения и применение к ним алгоритма выравнивания гистограмм Рисунок Исходное сбалансированное изображение Рисунок Полученное изображение Рисунок Исходное засвеченное изображение Рисунок Полученное изображение Рисунок Исходное затемненное изображение Рисунок Полученное изображение Полученные изображения одинаковы то есть результаты работа алгоритма совпадают на сбалансированном, засвеченном и затемнённом изображениях. Гистограмма Рисунок Гистограмма для исходного и полученного сбалансированного изображения Рисунок Гистограмма исходного и полученного затемненного изображения Рисунок Гистограмма исходного и полученного засвеченного изображения Заметим, что у затемнённого и засвеченного изображений даже после применения метода выравнивания гистограмм крайние пики” уходят достаточно неэффективно. Методы построения карты контуров на основе градационных преобразований Метод построение карты контуров заключается в следующем: в зависимости от выбора порога выходной пиксель бинарного значения соответствует белому интенсивность соответствующего пикселя исходного изображения превышает порог) или черному цвету иначе). Необходимо синтезировать градационную функцию преобразования для построения бинарного изображения. Порог принадлежит интервалу и изменяется с фиксированным шагом. Возьмём этот шаг равным Рисунок Бинарное изображение при Рисунок Бинарное изображение при Рисунок Бинарное изображение при Рисунок Бинарное изображение при Рисунок Бинарное изображение при Рисунок Бинарное изображение при Рисунок Бинарное изображение при В результате самым точным изображением оказалось изображение с Отсюда можно сделать вывод, что значение находящееся приблизительно в середине диапазона для сбалансированного изображения является наилучшим. При увеличении и уменьшении Т с середины будет уменьшаться количество деталей на изображении. Формирование наглядного бинарного изображения Рисунок Бинарное изображение при Значение находящееся приблизительно в середине диапазона для сбалансированного изображения является лучшим. Значения гораздо выше середины являются в данном случае худшими, т.к. на изображении просто белое. Значения гораздо больше среднего с увеличением порога теряют точность, однако разобрать возможно. Выводы В ходе выполнения лабораторной работы на исходное изображение были наложены аддитивный и импульсный шумы. Был сделан вывод о том, что импульсный шум сильнее ухудшает качество изображения. Эти ухудшения можно оценить визуально и по низким значениям Такие выводы объясняются тем, что пиксели при их изменении принимают максимально и минимально возможный значения: и В ходе работы были применены три фильтра для подавления шума: фильтр скользящего среднего, гауссовский и медианный. Был сделан вывод о том, что лучшим фильтром с точки зрения для маленьких значений шума является фильтр Гаусса. Это объясняется тем, что этот фильтр в отличие от остальных, имеет дополнительный параметр фильтр. Однако стоит заметить, что при больших значениях шума, все три фильтра работают примерно одинаково и слабо подавляют шум. Наихудший результат визуально дает медианный фильтр, т.к. вносит большую нечеткость и зернистость. Однако при наложении импульсного шума этот фильтр дает хорошие результаты. В ходе работы был применен оператор Лапласа с целью выделения контура изображения. Был сделан вывод о том, что при увеличении контур становится четче, но увеличивается яркость изображения. В ходе работы к исходному изображению был применен оператор Собеля. Был сделан вывод о том, что оператор Собеля наиболее точную бинарную карту дает при пороге или же при при меньших значениях на изображении очень много белых пикселей, при больших наоборот, было детектировано мало контуров. Были применены методы на основе опорных точек, выравнивания гистограмм и гамма-преобразование. Метод выравнивания гистограмм для засвеченного и затемнённого изображений приближают картинки к сбалансированному и выравнивают по всему диапазону значений пиксели. При этом наиболее точная карта контуров получается при значении порога Отсюда можно сделать вывод, что значение находящееся приблизительно в середине диапазона для сбалансированного изображения является лучшим. Значения гораздо выше середины являются в данном случае худшими, т.к. на изображении просто белое. Значения гораздо больше среднего с увеличением порога теряют точность, однако разобрать возможно. Листинг программы: Реализация модели аддитивного шума" Успешно выполенено для Реализация модели импульсного шума" Успешно выполенено для и Построение графиков Модель аддитивного шума:" Модель импульсного шума:" Метод скользящего среднего" Успешно выполенено для и Подбор размера окна для метода скользящего среднего" Фильтр Гаусса" Успешно выполенено для и Графики ОЧЕНЬ МЕДЛЕННО Графики построены" Максимальные значения Метод медианной фильтрации" Успешно выполенено для и ОЧЕНЬ МЕДЛЕННО РАБОТАЕТ Подбор размера окна для метода медианной фильтрации" МЕДЛЕННО Сравнение результатов при разных методах фильтрации" Вычисление значения Метод медианной фильтрации для импульсного шума" График Примение оператора Лапласа к изображению" Формирование изображения по отклику" Усиление высоких частот" Изображения с маской с различными Средняя яркость Применение оператора Собеля Применение оператора Собеля с различными значениями Карта направлений градиентов" Метод опорных точек" Гамма преобразование" Метод выравнивания гистограмм" Методы построения карты контуров на основе градационных преобразований" если детктирован как контур, то белый 