Цель работы: Изучение алгоритмов, используемый в базовом режиме стандарта анализ статисти- ческих свойств, используемых при сжатии коэффициентов дискретного косинусного преобразова- ния, а также получение практических навыков разработки методов блоковой обработки при сжа- тии изображения. Дискретное косинусное преобразование ДКП): Процедуру выполнения ДКП нагляднее описывать в форме матричного умножения. Мат- рицу преобразования Т принято называть ядром. Строки матрицы Т состоят из векторов, образо- ванных значениями косинусов где номер строки и значение частоты косинуса, нормирующий коэффициент и положение в пространстве ого отсчета, для которого Нормирующий коэффициент зависит от частоты и вычисляется следующим образом: иначе Значения матрицы вычисляются следующим образом: Прямое и обратное ДКП для двумерного случая в матричной форме выглядят следующим образом: где и являются матрицами размерности Реализация процедуры прямого и обратного ДКП для блоков Необходимо реализовать процедуру прямого и обратного ДКП, а также оценить вносимые этой процедурой искажения. Окончательные формулы прямого и обратного преобразований, ис- пользуемые в стандарте выглядят следующим образом: где Оценка искажений, вносимых ДКП: Рис. Исходное изображение Рис. Изображение после обратного ДКП. Рис. Значение для изображения после обратного ДКП. Рис. Исходное изображение Рис. Изображение после обратного ДКП. Рис. Значение для изображения после обратного ДКП. Рис. Исходное изображение Рис. Изображение после обратного ДКП. Рис. Значение для изображения после обратного ДКП. По полученным картинкам, видимых искажений после прямого и обратного ДКП не было обнаружено. Это подтверждают высокие значения Небольшие потери могли возникнуть при округлении до целых чисел. Квантование спектральных коэффициентов: В стандарте используется равномерное скалярное квантование. Предполагается ис- пользование индивидуального шага квантования для каждой полосы Шаги квантования для всех полос объединяются в матрицу квантования которая также имеет размерность Поскольку статистики спектров цветоразностных компонент в целом похожи и сильно от- личаются от спектра яркостной компоненты, на практике используют две таблицы квантования: для яркостной составляющей и для двух цветоразностных компонент. Реализация процедуры квантования и деквантования: Процедура квантования спектральных коэффициентов определяется следующим обра- зом: где шаг квантования, который является элементом соответствующей матрицы Кодированию будут подвергаться именно номера квантов а аппроксимирующие значе- ние каждого кванта будут вычисляться при декодировании как произведение номера кванта и шага квантования: где Матрицы квантования будут строиться по формуле: где целочисленный параметр, управляющий качеством обработки. Квантование для разных компонент происходило с помощью одинаковых матриц при значении от до Рис. График для изображения Рис. График для изображения Рис. График для изображения Рис. Изображение при Рис. Изображение при Рис. Изображение при Рис. Изображение при Рис. Изображение при Рис. Изображение при Рис. Изображение при Рис. Изображение при Рис. Изображение при Оценка влияния искажений, вносимых квантованием, на компоненты этих изобра- жений: По графикам видно, что значение яркостной компоненты уменьшается быстрее, чем компонент и Это связано с тем, что содержит основную информацию об изображении. Искажения, вносимые квантованием, можно разглядеть при приближении картинок: все изображение состоит из квадратов, и из-за этого контуры изображения становятся нечеткими. Рис. Сравнение изображения с квантованным при Рис. Сравнение изображения с квантованным при Рис. Сравнение изображения с квантованным при Сжатие без потерь: Кодирование является завершающим этапом работы кодера на котором происходит формирование битового потока. Кодирование каждой компоненты осуществляется независимо и состоит из следующих действий: Кодирование коэффициента постоянного тока Перегруппировка коэффициентов переменного тока и формирование одномер- ного массива в соответствии с зигзагообразной последовательностью. Применение кодирования длин серий для последовательности из коэффициен- тов. Кодирование пар Реализация процедуры кодирования квантованных коэффициентов постоянного тока Для кодирования используется разностный метод. Дальнейшей обработке подверга- ется разность коэффициента текущего и предыдущего обрабатываемого блоков: где номер текущего блока. Значение представляется в форме битовой категории и амплитуды где битовая категория от значения вычисляется как а значение амплитуды само коди- руемое значение. Оценка эффективности использования разностного кодирования для коэффициентов постоянного тока: Необходимо построить гистограммы частот и полученных для блоков яркостной составляющей тестового изображения и вычислить оценки энтропии. Рис. Гистограмма частот по для изображения Рис. Гистограмма частот по для изображения Рис. Гистограмма частот по для изображения Рис. Гистограмма частот по для изображения Рис. Гистограмма частот по для изображения Рис. Гистограмма частот по для изображения Рис. Значения энтропии для изображения Рис. Гистограмма частот по для изображения Рис. Гистограмма частот по для изображения Рис. Гистограмма частот по для изображения Рис. Гистограмма частот по для изображения Рис. Гистограмма частот по для изображения Рис. Гистограмма частот по для изображения Рис. Значения энтропии для изображения Рис. Гистограмма частот по для изображения Рис. Гистограмма частот по для изображения Рис. Гистограмма частот по для изображения Рис. Гистограмма частот по для изображения Рис. Гистограмма частот по для изображения Рис. Гистограмма частот по для изображения Рис. Значения энтропии для изображения Из полученных данных можно сделать вывод о том, что разностное кодирование уменьшает значение энтропии, а значит качество сжатия улучшается. Это связано с тем, что при разностном кодировании значительно увеличивается количество нулей и значений около нуля для массива Реализация процедуры кодирования длинами серий Сформированная в предыдущем пункте последовательность коэффициентов необхо- димо закодировать длинами серий. Данный этап кодирования состоит из частей: Перегруппировка коэффициентов переменного тока в соответствии с зигзагообраз- ной последовательностью. Этап кодирования длин серии, в результате которого предыдущая последовательность заменяется на новую последовательность, состоящую из пар опреде- ляет число нулевых значений в серии, а ненулевой завершающий элемент серии. Если в старой последовательность не остается ненулевых значений, то в конце новой последовательности ставится пара Значение заменяется на пару Определение соотношений размеров в сжатом битовом потоке: Необходимо определить соотношение размеров в сжатом битовом потоке для следующих данных: Рис. График степень сжатия) для изображения Рис. Вычисление соотношений Рис. График степень сжатия) для изображения Рис. Вычисление соотношений Рис. График степень сжатия) для изображения Рис. Вычисление соотношений Дополнительное задание: Постройте зависимости степень сжатия) для компонент использованных изобра- жений, а также нанесите на эти графики зависимость степень сжатия) для ух изображе- ний: Аддитивный белый гауссовский шум при Импульсный шум с равновероятным появлением и Сделать выводы по полученным зависимостям. Решение: Рис. Белый гауссовский шум Рис. Импульсный шум с Рис. Исходное изображение. Таким образом, импульсный шум сжимается куда хуже, чем что-либо ещё. При этом, если смотреть на графики исходных изображений, то изображение среди них сжимается явно хуже всего, а при степени сжатия примерно имеет равный чуть меньше ти. Таким образом, эффективность сжатия напрямую зависит от особенностей самого изображения. Выводы: В ходе выполнения лабораторной работы было выявлено, что с помощью дискретного ко- синусного преобразования можно получить спектральные коэффициенты изображения. Энергия спектра каждого блока концентрируется в левом верхнем углу. После ДКП изображение восста- навливается четко, что можно увидеть на изображениях. Потери возможны в связи с погрешно- стями при вычислениях. Следующим этапом лабораторной работы стало равномерное скалярное квантование. При увеличении уменьшается значение Для компоненты данные изменения заметны силь- нее, так как она несет основную информацию, в отличии от компонент и Кроме того, на восстановленных изображениях размыты контура, так как изображение состоит из квадратных блоков. При разностном кодировании частоты коэффициентов постоянного тока находятся около нуля, то есть их диапазон сужается, что видно по гистограммам. Кроме того, разностное кодиро- вание уменьшает энтропию, а значит способствует эффективному сжатию. Значения переменного тока берутся в зигзагообразном порядке, так как ДКП концентрирует значения в верхнем левом углу. В последовательности может оказаться много нулей, то есть повторяющихся значений, це- лесообразно кодировать ее методом длин серий Наибольший процент в сжатом битовом потоке отводится на так как этих пар больше всего. С увеличением радиуса меняется соотношение размеров в сжатом битовом потоке. При больших параметрах сжатия, то есть при больших сильно заметны границы блоков, размытие. Листинг программы: 