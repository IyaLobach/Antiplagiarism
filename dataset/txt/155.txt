 1  Цель работы: для выбранного варианта задания разработать и отладить программу моделирования, выполнить моделирование для нескольких значений отношения сигнал/шум, вычислить значения вероятности ошибки или ее верхней границы по соответствующим теоретическим формулам и построить графики.  1. Исходные данные для варианта 4 КАМ  𝑓0=2400 Гц 𝑉𝑚𝑜𝑑=600 бод 𝑉𝑖𝑛𝑓=2400 бит/с  2. Базис для геометрического представления сигналов КАМ 𝜑1(𝑡)= {√2𝑇cos(2𝜋𝑓0𝑡),0<𝑡<𝑇 0,иначе 𝜑2(𝑡)= {√2𝑇sin(2𝜋𝑓0𝑡),0<𝑡<𝑇 0,иначе  Данные функции образуют базис размерности 𝐷 = 2.  3. Моделирование передачи по каналу и оптимального приема Цель выполнения этого задания состоит в построении программной модели канала с АБГШ и приемника, реализующего алгоритм оптимального приема. В результате моделирования должны быть получены оценки вероятности ошибки приема сигнала для разных отношений сигнал/шум.  Процесс моделирования состоит в многократном выполнении следующих шагов:  – случайный равновероятный выбор номера сигнала 𝑖,подлежащего передаче, 𝑖=0,1,…𝑞−1;  – получение сигнала 𝑟(𝑡) на выходе канала согласно равенству 𝑟(𝑡)=𝑠𝑖(𝑡)+𝑛(𝑡), где 𝑛(𝑡) – АБГШ со спектральной плотностью мощности 𝑁0/2;  – вычисление вектора 𝑟=(𝑟1,𝑟2,…𝑟𝐷) с компонентами 𝑟𝑗(𝑡)= ∫𝑟(𝑡)𝜑𝑗(𝑡)𝑑𝑡𝑇0;  – формирование решения 𝑖̂. Для определения минимального расстояния до 𝑠𝑖, будет вычисляться 𝑑(𝑟,𝑠𝑖)= √∑(𝑟𝑗−𝑠𝑖𝑗)2𝐷𝑗=1.  – фиксации результата: если 𝑖̂ ≠𝑖, то решение на приемной стороне сформировано неправильно и нужно увеличить счетчик числа ошибок.   2  Оценка вероятности ошибки получается путем деления числа произошедших ошибок на число испытаний. При большом числе испытаний эта оценка должна быть близка к истинной вероятности ошибки или к ее верхней границе, которые вычисляются по соответствующим формулам.  Указанные шаги выполняются для нескольких значений отношения сигнал шум, в результате получается зависимость оценки вероятности ошибки, полученной экспериментально, от отношения сигнал/шум. Эта зависимость при правильном выполнении задании должна хорошо соотноситься с теоретической зависимостью вероятности ошибки от отношения сигнал/шум. Формулы для вероятности ошибки от отношения сигнал/шум, определяющие теоретическую зависимость, могут быть, например, найдены в соответствующем разделе пособия [1].  Исходными данными для моделирования являются следующие:  – набор значений отношения сигнал шум 𝛾𝑑𝐵(1),𝛾𝑑𝐵(2),…,𝛾𝑑𝐵(𝑛);  – сигнальное множество {𝑠𝑖(𝑡)},𝑖=0,1,…,𝑞−1;  – функциональный базис {𝜑𝑗(𝑡)},𝑗=1,2,…𝐷;  – описание решающих областей 𝑅𝑖,𝑖=0,1,…,𝑞−1. В результате моделирования должны быть экспериментально получены оценки вероятности ошибки 𝑃𝑒(1),𝑃𝑒(2),…,𝑃𝑒(𝑛), соответствующие значениям отношения сигнал/шум 𝛾𝑑𝐵(1),𝛾𝑑𝐵(2),…,𝛾𝑑𝐵(𝑛).  Верхняя граница ошибки для КАМ:  𝑃𝑒<exp (−3?̅?2(𝑞−1)𝑁0)    3   4. Графики моделирования  График 1 - 𝑌 =5𝑑𝐵   График 2 - Y=15𝑑𝐵  4  Теоретическая и экспериментальная зависимость вероятности ошибки от отношения сигнал-шум при максимальном количестве ошибок 80:   Вывод: в ходе лабораторной работы была промоделирована работа оптимального приёмника дискретных сигналов в канале с белым аддитивным белым гауссовским шумом, был получен сигнал 𝑟(𝑡) на выходе приёмника и вычислен вектор r, а также было произведено формирование решения ?̂? и фиксация результата. Была произведена оценка вероятности ошибки теоретическим и экспериментальным путём. Было зафиксировано, что при увеличении SNR вероятность ошибки снижается.    5  Листинг программы:  clc clear all f0 = 2400; Vmod = 600; Vinf = 2400; T = 1/Vmod; m = Vinf/Vmod; q = 2^m;   i1 = zeros(1, q); i2 = zeros(1, q); s1 = zeros(1, q); s2 = zeros(1, q); val = 0; A = 3; indx = 0; step = T/1000; t = 0:step:T;   %расчет индексов для КАМ for j=1:1:q     i1(j) = val;     indx = indx + 1;     if(indx == A+1)         indx = 0;         val = val +1;     end     i2(j) = mod(j-1,A+1);          s1(j) = A * (1 - (2*i1(j))/(sqrt(q)-1));     s2(j) = A * (1 - (2*i2(j))/(sqrt(q)-1)); end   Signals = @(n,t) ((s1(n)*sqrt(2/T)*cos(2*pi*f0*t))+ (s2(n)*sqrt(2/T)*sin(2*pi*f0*t))); % вычисление сигналов s = zeros(q,length(t)); for c = 1:q     s(c,:) = Signals(c,t); end E_sr = sum(s .* s) / (q);   phi1 = @(t) sqrt(2/T)*sin(2*pi*f0*t); phi2 = @(t) sqrt(2/T)*cos(2*pi*f0*t); si1(j) = integral(@(t) Signals(j-1,t).*phi1(t), 0, T); si2(j) = integral(@(t) Signals(j-1,t).*phi2(t), 0, T); phi_1 = sqrt(2/T)*sin(2*pi*f0*t); phi_2 = sqrt(2/T)*cos(2*pi*f0*t); %расчет координат for n=1:1:q     si1(n) = integral(@(t) Signals(n,t).*phi1(t), 0, T);     si2(n) = integral(@(t) Signals(n,t).*phi2(t), 0, T); end  6      %  разбиение сигнального пространства на решающие области figure(1); plot(si1(:),si2(:), '.', 'MarkerSize', 20); for n = -4:2:4     line ([n n], [-4 4]);     line ([-4 4], [n n]); end hold on;   % моделирование приемника YdB = 1 : 1 : 5; % рандомное число Pe = zeros(1,length(YdB)); % вектор ошибок Pe_tub = zeros(1, length(YdB)); % теоретическая ошибка N_err_max = 80; for n = 1 : length(YdB)      Y = 10 ^ (n / 10); % отношение сигнал/шум      sigma = sqrt(sum(E_sr / (2 * Y)));   %      N_err = 0;      N_test = 0;      while (N_err < N_err_max) % для одного значения гамма          i = randi(q);          r = s(i,:) + sigma .* randn(1,length(s(i,:))); %шумим сигнал \ \ randn - загуглить\\ мат ожидание и дисперсия, чему равны значения          r1 = trapz(t,r .* phi_1); %это Х \\ итеграл, который вычислеятся методом трапеции          r2 = trapz(t,r .* phi_2); %это У          if (n == length(YdB)) % потому чтоищем отношение сигнал шум              plot(r1, r2, 'b.','MarkerSize', 15);              hold on;          end           min_d = 1000000000;          min_index = -1;          for k = 1:q %соотносим к сигналу,               d = sqrt((r1 - si1(k))^2 + (r2 - si2(k))^2);               if (d < min_d)                     min_d = d;                     min_index = k;              end           end          if  i~= min_index             N_err = N_err+ 1;          end          N_test = N_test + 1;      end      Pe(n) = N_err/N_test;      Pe_tub(n) = exp(-3 / (2*(q - 1)) *Y); end    7  % вероятность ошибки figure(2); semilogy(YdB, Pe_tub, 'black-', YdB, Pe, 'red.-','MarkerSize',10); legend('Theoretical error','Experimental error'); grid on xlabel('Ydb'); ylabel('P_E');  