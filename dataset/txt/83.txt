Цель работы: Получение практических навыков использования алгоритмов улучшения качества изобра- жений, применяемых в пространственной области, на примерах методов шумоподавления, выде- ления контуров и градационных преобразований для упрощения анализа рассматриваются только однокомпонентные изображения). Реализация модели аддитивного шума: При выполнении пунктов лабораторной работы будет проводиться работа с яркостной со- ставляющей изображения компонентой, значение в пикселе которой вычисляется по следующей формуле: где и значения цветовых компонент формата для соответствующего пикселя. Модель формирования аддитивного шума для битных значений интенсивности пикселей изображения можно представить следующим образом: где значение шума на позиции пикселя с координатами а операция клиппиро- вания, соответствующая следующей формуле: Значение шума можно сгенерировать, воспользовавшись преобразованием Бокса- Мюллера. Пусть и независимые случайные величины, равномерно распределенные на интервале и и определены как Тогда и независимы и имеют нормальное распределение с математическим ожида- нием и дисперсией Чтобы перейти к общему нормальному распределению воспользуемся формулой: где математическое ожидание, стандартное отклонение, а случайная величина с Гауссов- ским распределением Результаты формирования аддитивного шума: Рис. Изображение с аддитивным шумом при Из полученного изображения видно, что при значении можно заметить шум на кар- тинке. Реализация модели импульсного шума: Модель формирования импульсного шума для битных значений интенсивностей описы- вается следующей формулой: с вероятностью с вероятностью с вероятностью где и параметры системы. Результаты формирования импульсного шума: Рис. Изображение с импульсным шумом при Как видно на изображении импульсный шум более выражен чем аддитивный, так как за- шумленные пиксели принимают крайние значения или Построение графиков для аддитивного и импульсного шумов: можно вычислить по формуле: Рис. График зависимости от Рис. График зависимости от По данным графикам видно какие искажения вносят импульсный и аддитивные шумы. Им- пульсный шум даже при малых параметрах очень ухудшает качество картинки, так как максималь- ное значение равно в то время как у аддитивного шума максимальный равен Это объясняется тем, что импульсный шум изменяет компоненту либо в либо в Аддитивный шум на малых размерах изменяет компоненту на небольшую величину, тем самым падает не так критично. Обработка изображений с аддитивным шумом: В процессе выполнения фильтрации входного зашумленного) изображения форми- руется новое изображение с теми же размерами. Каждый пиксель формируется в ре- зультате применения некоторого оператора к пикселю и подмножеству соседних с ним пиксе- лей, образующих так называемую апертуру) фильтра. Применяемый оператор может быть как линейным, так и нелинейным. При линейной фильтрации используется следующее правило для расчета значений отфильтрованных пикселей: где радиус фильтра, определяющий апертуру, весовые коэффициенты фильтра, ко- эффициент нормировки, определяемый по формуле: Следует отметить, что использование термина радиус” является общепринятым, хотя в ре- альности апертура имеет форму квадрата со стороной На краях массива где апертура вы- ходит за границы изображения, недостающее значение, как правило, заменяется интенсивностью ближайшего по Евклидову расстоянию пикселя. Реализация метода скользящего среднего: В методе скользящего среднего значения весовых коэффициентов постоянны и не зависят от расстояния до центрального пикселя. Все весовые коэффициента равны единице, в связи с этим выход фильтра рассчитывается по следующей формуле: Результаты применения фильтра: Рис. Изображение с аддитивным шумом при Рис. Изображение после применения фильтра при Как видно из приведенных рисунков отфильтрованное изображение получилось немного размытым, но шум удалось сгладить”. Значение увеличилось с до Подбор оптимального размера окна Определим значение для и такое, что значение будет макси- мальным. Рис. Результат работы программы. Таким образом, максимальное значение для всех значений достигается при разме- рах окна С увеличением значения сигмы шума уменьшается и получаемый Реализация метода Гауссовской фильтрации: Поскольку на фотореалистичном изображении соседние пиксели сильно коррелируют, зна- чения весовых коэффициентов как правило, рассчитываются на базе некоторой функции от рас- стояния до центральной позиции значения которой убывают по мере удаления позиции коэф- фициента от центральной. Однако такой подход имеет негативный эффект с точки зрения визуаль- ного восприятия. В окрестности контуров резких перепадов) применение линейных фильтров приводит к размытию” контура. Поэтому данный класс фильтров также называют фильтрами раз- мытия. Функция расстояния для расчёта значений весовых коэффициентов формируется на базе функции Гаусса от двух переменных отсюда и название фильтра): где параметр фильтра, определяющий скорость убывания коэффициентов по мере удаления от позиции центрального пикселя. Результат применения фильтра: Рис. Изображение с аддитивным шумом при Рис. Изображение после применения фильтра при После фильтрации так же присутствует эффект размытия. Значение увеличилось с до Построение графиков Рис. График при Рис. График при Рис. График при Из полученных графиков можно сделать вывод о том, что при значениях фильтра зна- чения при всех рассматриваемых шумах и значениях перестают увеличиваться, а при ма- лых шумах начинает уже уменьшаться. Подбор оптимальных параметров: Исходя из графиков, полученных в пункте определим оптимальные параметры для каждого значения шума и при которых значение будет максимальным: При шума фильтра При шума фильтра При шума фильтра При шума фильтра При шума фильтра Как видно из полученных значений чем больше значение шума, тем больше значение при котором максимально. Реализация метода Медианной фильтрации: Медианный фильтр является фильтром, основанным на порядковых статистиках частном случае нелинейное фильтрации. Алгоритм медианной фильтрации для пикселя можно предста- вить в виде следующих шагов: Формирование одномерного массива А из апертуры пикселя Взятие медианы одномерного массива А. Взятие медианы по массиву А происходит следующим образом: Производится сортировка элементов одномерного массива А по убыванию или воз- растанию) Сохранить в элемент, находящийся в середине отсортированного массива А. Для апертуры радиуса необходимо взять из отсортированного массива элемент с ин- дексом Результат применения фильтра: Рис. Изображение с аддитивным шумом при Рис. Изображение после применения фильтра при На выходе фильтра получение очень нечеткое изображение. Шум на изображении удалось сгладить, а контуры размыты. Значение увеличилось с до Визуально вос- принимать отфильтрованное изображение сложнее, чем зашумленное. Подбор оптимального параметра Определим значение для и такое, что значение будет макси- мальным. Рис. Результат работы программы. Таким образом, при зашумленности принимает максимальное значение при В случае большой зашумленности, когда наибольшее значение достигается при С увеличением значения сигмы шума уменьшается и получаемый Анализ при применении различных фильтров: Сформируем изображения с различными аддитивными шумами при Прове- дем фильтрацию этого изображения различными фильтрами и проанализируем максимальное зна- чение полученные в результате работы каждого фильтра. При шума равной Рис. Изображение с шумом Рис. Изображение после фильтра Гаусса Рис. Изображение после фильтра методом скользящего среднего Рис. Изображение после медианного фильтра При шума равной Рис. Изображение с шумом Рис. Изображение после фильтра Гаусса Рис. Изображение после фильтра методом скользящего среднего Рис. Изображение после медианного фильтра При шума равной Рис. Изображение с шумом Рис. Изображение после фильтра Гаусса Рис. Изображение после фильтра методом скользящего среднего Рис. Изображение после медианного фильтра При шума равной Рис. Изображение с шумом Рис. Изображение после фильтра Гаусса Рис. Изображение после фильтра методом скользящего среднего Рис. Изображение после медианного фильтра При шума равной Рис. Изображение с шумом Рис. Изображение после фильтра Гаусса Рис. Изображение после фильтра методом скользящего среднего Рис. Изображение после медианного фильтра Визуально можно заметить, что метод Гаусса и скользящего среднего эффективнее улуч- шают изображение, чем метод медианной фильтрации, который даже при слабом шуме заметно ухудшает изображение. В некоторых случаях значение лучше, чем у фильтра Гаусса и скользящего среднего, однако воспринимается данное изображение значительно хуже, чем даже зашумленное изображение. Анализ после применения различных фильтров: Построим графики зависимости для между исходным и зашумленным изоб- ражениями и максимальных между исходным и отфильтрованными изображениями для каждого фильтра. Рис. Графики зависимости По графикам видно, что для изображений с лучшей фильтрацией является фильтр Гаусса. Для изображений с лучшей фильтрацией являются фильтры скользящего среднего и медианный. Для больших значений сигмы все фильтры дают примерно одинаковый результат, однако визуально для медианного фильтра изображения воспринимается гораздо хуже. Обработка изображений с импульсным шумом: Наложение шума на изображение: Наложим на изображение импульсные шума так, чтобы доли искаженных пикселей со- ставляли: и Рис. Изображение с импульсным шумом при Рис. Изображение с импульсным шумом при Рис. Изображение с импульсным шумом при Рис. Изображение с импульсным шумом при Вычисление по зашумленным изображениям: Определим значения для изображений, сформированных в предыдущем пункте. Ре- зультаты вычислений: Рис. Результат работы программы. Применение медианной фильтрации: Результат работы: Рис. Отфильтрованное изображение с импульсным шумом при при Рис. Отфильтрованное изображение с импульсным шумом при при Рис. Отфильтрованное изображение с импульсным шумом при при Рис. Отфильтрованное изображение с импульсным шумом при при По полученным изображениям можно сделать вывод, что изображения получились смазан- ными, медианная фильтрация позволила полностью избавиться от шума. При большом шуме изоб- ражение стало визуально восприимчивым по сравнению с зашумленным. Это связано с тем, что данный метод игнорирует крайние значения интенсивности, которые и принимает пиксель при импульсном шуме. Анализ разных вариантов фильтрации: Построим зависимость для всех вариантов зашумленных изображений и проведем анализ полученных результатов. Рис. Графики зависимости Из полученных графиков видно, что при зашумлённости наибольшие значе- ния достигаются при размере окна При зашумленности наибольшее значение достигаются при Реализация методов выделения контуров: Применение оператора Лапласа и формирование изображения по отклику: Необходимо применить оператор Лапласа к изображению и получить отклик вос- пользовавшись формулой где в качестве весовых коэффициентов будут использоваться элементы масок: Рис. Маски. Рис. Отклик после применения первой маски. Рис. Отклик после применения второй маски. По полученному отклику оператора Лапласа необходимо сформировать изображение. Значение пикселя на позиции вычисляется по следующей формуле: В итоге получаем: Рис. Изображение после применения первой маски. Рис. Изображение после применения второй маски. По полученным изображениям можно увидеть разницу в применении масок. Например, после использования первой маски белые контуры у попугаев, а после второй маски черные. Синтез изображения с усилением высоких частот: Необходимость синтезировать изображение с усилением высоких частот, используя раз- ность исходного изображения и отклика оператора Лапласа применив следующую маску: Рис. Маска. Значение пикселя на позиции синтезированного изображения вычисляется по следу- ющей формуле: Полученный результат: Рис. Изображение до изменений. Рис. Синтезированное изображение на основе второго отклика. Сравнивая исходное изображение и синтезированное, можно сделать вывод о том, что при прибавлении к исходному изображению отклик оператора Лапласа контуры объектов становятся четче видны. Синтез изображений с различными значениями параметра Необходимо синтезировать изображения, применив маску, приведенную на рис. для раз- ных значений параметра Параметр изменяется в интервале от до с шагом Результаты синтеза: Рис. Синтезированное изображение при Рис. Синтезированное изображение при Рис. Синтезированное изображение при Рис. Синтезированное изображение при Рис. Синтезированное изображение при Рис. Синтезированное изображение при По полученным изображениям можно сделать вывод, что при увеличении общая яркость изображения увеличивается, а резкость уменьшается. Синтезированное изображение совпадает с при Докажем данное утверждение: что соответствует маске на рисунке при Средние значения яркости: Необходимо рассчитать среднее значение яркости для каждого из изображений, получен- ных в предыдущем пункте. В итоге имеем: Рис. Результат работы программы. Построение и анализ гистограмм: Построим гистограмму для исходного изображения, а также гистограммы для изображе- ний, полученных в пункте Рис. Гистограмма исходного изображения. Рис. Гистограмма изображения при Рис. Гистограмма изображения при Рис. Гистограмма изображения при Рис. Гистограмма изображения при Рис. Гистограмма изображения при Рис. Гистограмма изображения при По полученным гистограммам можно заметить, что при увеличении уменьшается общее количество пикселей с интенсивностью компоненты и увеличивается крайний правый пик количество пикселей с интенсивностью компоненты равной Это связано с постепенным осветлением изображения все больше компонент пикселей принимают свое максимальное зна- чение. Реализация оператора Собеля: Оператор Собеля является ключевым во многих алгоритмах анализа контуров изображе- ния. В основе оператора Собеля лежит расчет двух производных: по вертикали и по горизонтали. Соответствующие этим операциям маски фильтров: Рис. Маски фильтров в операторе Собеля. Алгоритм применения оператора: Рассчитать значения откликов и используя фильтры с масками. Рассчитать величину силы длины) контура по формуле: Рассчитать направление градиента Результат: Рис. Результат применения оператора Собеля. Формирование изображений с различными порогами Рис. Результат применения оператора Собеля при Рис. Результат применения оператора Собеля при Рис. Результат применения оператора Собеля при Рис. Результат применения оператора Собеля при Рис. Результат применения оператора Собеля при Рис. Результат применения оператора Собеля при По сформированным изображениям можно сделать вывод, что наиболее точными бинар- ными картами являются карты с порогами и При и изображения в некоторых местах перегружены белыми пикселями. При и некоторые контуры становятся четче различимых, а некоторые исчезают вовсе. Карта направлений градиентов: Необходимо построить цветную карту направлений градиентов на полученных изобра- жениях по следующему правилу: Рис. Правило построения цветной карты. Результат: Рис. Карта направлений градиентов. Реализация градационных преобразований: Синтез засвеченного, затемненного, сбалансированного изображений: Рис. Сбалансированное изображение. Рис. Синтезированное засвеченное изображение. Рис. Синтезированное затемненное изображение. Преобразование на базе двух опорных точек: К полученным в предыдущем пункте изображениям нужно применить градационное пре- образование на базе двух опорных точек для повышения их качества. Метод опорных точек один из простейших методов улучшения качества изображения на основе анализа и видоизменения ги- стограммы основывается на использовании метода опорных точек. На основе точек и и двух опорных точек, которые задает человек, входное значение преобразуется с помо- щью линейной интерполяции в новое значение. Результаты преобразования: Рис. Исходное сбалансированное изображение. Рис. Преобразование изображения на основе опорных точек и Рис. Исходное затемненное изображение. Рис. Преобразование изображения на основе опорных точек и Рис. Исходное засветленное изображение. Рис. Преобразование изображения на основе опорных точек и Формирование гистограмм: Необходимость сформировать и проанализировать гистограммы для исходных и получен- ных изображений из предыдущего пункта. Результат: Рис. Гистограмма сбалансированного изображения до и после преобразования. Рис. Гистограмма засветленного изображения до и после преобразования. Рис. Гистограмма затемненного изображения до и после преобразования. По полученным гистограммам можно увидеть, что преобразование не влияет на количество пикселей с крайними значениями компонент относительно других пикселей, но поднимает коли- чество отдаленных от крайних пикселей. Гамма-преобразования: Необходимо получить графики уравнения для различных значений пара- метра для каждого из трёх входных изображений. Однако перед применением формулы выше следует привести входное значение в диапазон Выходное значение возвращают в диапазон путем умножения на Результат: Рис. Исходное сбалансированное изображение. Рис. Преобразованное исходное сбалансированное изображение при Рис. Преобразование исходное сбалансированное изображение при Рис. Преобразование исходное сбалансированное изображение при Рис. Преобразование исходное сбалансированное изображение при Рис. Преобразование исходное сбалансированное изображение при Рис. Исходное затемненное изображение. Рис. Преобразование исходное затемненное изображение при Рис. Преобразование исходное затемненное изображение при Рис. Преобразование исходное затемненное изображение при Рис. Преобразование исходное затемненное изображение при Рис. Преобразование исходное затемненное изображение при Рис. Исходное засвеченное изображение. Рис. Преобразование исходное засвеченное изображение при Рис. Преобразование исходное засвеченное изображение при Рис. Преобразование исходное засвеченное изображение при Рис. Преобразование исходное засвеченное изображение при Рис. Преобразование исходное засвеченное изображение при По полученным результатам можно сделать вывод, что при значениях яркость изоб- ражения увеличивается, а при уменьшается. Таким образом, для улучшения качества засве- ченного изображения нужно брать значения для затемненного При изображение сов- падает с исходным. Формирование гистограмм: Необходимо сформировать и проанализировать гистограммы для исходных и полученных изображений из предыдущего пункта. Рис. Гистограмма исходного сбалансированного изображения. Рис. Гистограмма исходного сбалансированного изображения при Рис. Гистограмма исходного сбалансированного изображения при Рис. Гистограмма исходного сбалансированного изображения при Рис. Гистограмма исходного сбалансированного изображения при Рис. Гистограмма исходного сбалансированного изображения при Рис. Гистограмма исходного затемненного изображения. Рис. Гистограмма исходного затемненного изображения при Рис. Гистограмма исходного затемненного изображения при Рис. Гистограмма исходного затемненного изображения при Рис. Гистограмма исходного затемненного изображения при Рис. Гистограмма исходного затемненного изображения при Рис. Гистограмма исходного засвеченного изображения. Рис. Гистограмма исходного засвеченного изображения при Рис. Гистограмма исходного засвеченного изображения при Рис. Гистограмма исходного засвеченного изображения при По полученным данным можно убедиться, что вывод, сделанный в прошлом пункте, вер- ный. Также можно сказать, что гамма преобразование повышает контрастность изображения. Рис. Гистограмма исходного засвеченного изображения при Рис. Гистограмма исходного засвеченного изображения при Методы выравнивания гистограмм: Выравнивание гистограммы может быть использовано в задаче улучшения качества изоб- ражений. Данный подход может увеличить контрастность обрабатываемого изображения. Для вы- полнения операции выравнивания гистограмм следует воспользоваться формулой на базе эмпири- ческой функции распределения: где максимально допустимое число градаций интенсивности на изображении, значе- ние интенсивности в выходном изображении, в которое будет преобразовываться общее число пикселей и число пикселей, имеющих яркость. Необходимо синтезировать засвеченное, затемненное, а также сбалансированное изображения и применить к ним алгоритм выравнивания гистограмм. Результат: Рис. Исходное сбалансированное изображение. Рис. Обработанное сбалансированное изображение. Рис. Исходное засветленное изображение. Рис. Обработанное засветленное изображение. Рис. Исходное затемненное изображение. Рис. Обработанное затемненное изображение. Результаты работы алгоритма совпадают на сбалансированном, засвеченном и затемнен- ном изображениях рис. Формирование гистограмм: Рис. Гистограмма исходного сбалансированного изображения. Рис. Гистограмма исходного сбалансированного изображения после применения метода. Рис. Гистограмма исходного засветленного изображения. Рис. Гистограмма исходного засветленного изображения после применения метода. Рис. Гистограмма исходного затемненного изображения. Рис. Гистограмма исходного затемненного изображения после применения метода. У затемненного и засвеченного изображений даже после применения метода выравнивания гистограмм крайние пики” уходят неэффективно. Методы построения карты контуров на основе градационных преобразований: Метод построения карты контуров заключается в следующем: в зависимости от выбора по- рога Т выходной пиксель бинарного значения соответствует белому интенсивность соответству- ющего пикселя исходного изображения превышает порог) или черному цвету иначе). Необходимо синтезировать градационную функцию преобразования для построения би- нарного изображения. Порог Т принадлежит интервалу и изменяется с фиксированным шагом Результат синтеза: Рис. Исходное сбалансированное изображение. Рис. Бинарное изображение при Рис. Бинарное изображение при Рис. Бинарное изображение при Рис. Бинарное изображение при Рис. Бинарное изображение при Рис. Бинарное изображение при Рис. Бинарное изображение при Рис. Бинарное изображение при Изображение, полученное при вышло наиболее наглядным, так как достаточно хо- рошо видны мелкие детали и общий контур различим. Выводы: В ходе лабораторной работы, определили, что импульсный шум сильнее ухудшает изобра- жение в сравнении с аддитивным, так как пиксели изображения принимают значения либо либо с заданной вероятностью. Благодаря дополнительному входному параметру лучшим фильтром для аддитивного шума является фильтр Гаусса, но только при небольших значениях сигмы шума. При высоких значениях фильтр Гаусса справляется плохо, как и остальные фильтры даже для наилучших значений). Медианный фильтр дает наихудший визуальный результат, размывая изоб- ражения, но эта особенность помогает ему лучше справляться с импульсным шумом. Оператор Лапласа при увеличении параметра альфа увеличивает общую яркость изображе- ния. В результате применения оператора Лапласа и маски при можно заметить, что контуры стали четче, а результат совпадает со второй производной Оператор Собеля выдает наиболее точную бинарную карту при и При мень- ших значениях изображение в некоторых местах перегружено белыми пикселями, а при боль- ших происходит ухудшение четкости контуров. Методы опорных точек и гамма-преобразования помогают изменить оттенки серого, не за- трагивая крайних значений пикселя. В методе опорных точек необходим человек, который будет подбирать оптимальные значения. Метод выравнивания гистограмм для засвеченного и затемнён- ного изображений приближают картинки к сбалансированному и выравнивают пиксели по всему диапазону значений. Метод на основе градационных преобразований дает наиболее точную карту контуров при значении порога Листинг программы: и 