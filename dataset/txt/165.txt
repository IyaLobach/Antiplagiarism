1  Оглавление Цель работы: ............................................................................................................................... 2 1. Написать программу вычисления прямого и обратного преобразования Фурье в матричной форме. ........................................................................................................................ 2 Вывод 1: ........................................................................................................................................ 4 2. Продемонстрировать с помощью написанной программы свойства линейности, сдвига сигнала во времени и равенство Парсеваля. .............................................................................. 4 1. Линейность: ........................................................................................................................... 4 2. Задержка (сдвиг по времени): ................................................................................................. 5 3. Равенство Парсеваля: ............................................................................................................. 6 Вывод 2: ........................................................................................................................................ 7 3. Произвести декодирование аудио-файла с записью тонального сигнала (Dual-Tone Multi-Frequency (DTMF)) сигнала в формате WAV PCM 16 bit, mono. ............................................... 7 Вывод 3: ........................................................................................................................................ 9 4. Выполнить оценку смещения между двумя изображениями путем анализа фазового спектра. ...................................................................................................................................... 10 Вывод 4: ...................................................................................................................................... 10 Вывод по всей лабораторной работе: ........................................................................................ 10                    2  Цель работы:  Изучение методов Фурье-анализа для дискретных и цифровых сигналов. 1. Написать программу вычисления прямого и обратного преобразования Фурье в матричной форме.  Дискретное преобразование Фурье является быстрым способом Фурье-анализа, которое можно применить к цифровым сигналам.    Прямое дискретное преобразование Фурье для непрерывной периодической функции вычисляется по формуле: ?̇?𝑘= 1𝑁∑𝑢𝑛𝑒−𝑗2𝜋𝑛𝑁𝑘𝑁−1𝑛=0   При добавление нормирующего коэффициента 1𝑁 перед знаком суммы, как правило, применяется при вычислении обратного ДПФ вместо прямого.    Обратное дискретное преобразование Фурье можно вычислить по формуле: 𝑢𝑛=∑?̇?𝑘𝑒𝑗2𝜋𝑛𝑁𝑘𝑁−1𝑘=0    Поскольку прямое и обратное дискретное преобразование Фурье можно интерпретировать в терминах операций над векторами, поэтому формулы (1.1) и (1.2) можно представлять в матричной форме:  ?⃗? = ?⃗? 𝐹𝐻    ?⃗? = ?⃗? 𝐹      Где F – матрица N×N, заполненная комплексными экспонентами 𝑒𝑗2𝜋𝑛𝑁𝑘, а 𝐹𝐻 – эрмитово сопряженная матрица с F.   Рисунок 1. Матрица F Результат работы программы:   Результат работы программы для функции 𝑢(𝑡)=sin(2𝜋𝑓𝑡)  при 𝑓=20   3   Рисунок 2. Исходный сигнал  Рисунок 3. Прямое дискретное преобразование Фурье.  Рисунок 4. Восстановленный сигнал, по средствам обратного ДПФ 4   Рисунок 5. Совпадение исходного и восстановленного сигналов Вывод 1:  Мы познакомились с дискретным преобразованием Фурье в комплексном виде. Выяснили , что прямое преобразование позволяет перевести сигнал из временной области в частотную (получить спектр), а обратное преобразование Фурье позволяет перевести сигнал из частотной области во временную. Была написана программа для прямого и обратного преобразования Фурье, судя по совпадению исходного и восстановленного сигналов, можно сделать вывод о корректности программы.  2. Продемонстрировать с помощью написанной программы свойства линейности, сдвига сигнала во времени и равенство Парсеваля.  1. Линейность: 𝛼1𝑢𝑘(1)+𝛼2𝑢𝑘(2)↔ 𝛼1?̇?𝑛(1)+𝛼2?̇?𝑛(2)   Спектр суммы сигналов равен сумме спектров этих же сигналов. Для проверки свойства линейности возьмем две функции:  𝑢1(𝑡)=𝑠𝑖𝑛 (2𝜋𝑓1𝑡)  и   𝑢2(𝑡)=𝑠𝑖𝑛 (2𝜋𝑓2𝑡)  Частоты функций: 𝑓1=20 и  𝑓2=10 Коэффициенты: 𝛼1 = 13, 𝛼2 = 5; 5   Рисунок 6. Сигнал 𝛼1⋅ 𝑢1+𝛼2⋅ 𝑢2  Рисунок 7. Обратное ДПФ от сигнала 𝛼1⋅ ?̇?1+𝛼2⋅ ?̇?2  По графикам видно, что сумма исходного сигнала совпадает с суммой восстановленного сигнала, после применения дискретного преобразования Фурье.   2. Задержка (сдвиг по времени): 𝑢𝑘−𝜏↔ ?̇?𝑛𝑒−𝑗2𝜋𝑛𝑁𝜏   При сдвиге во временной области, график амплитудного спектра не изменяется. 6   Рисунок 8. График амплитудного спектра без сдвига по времени  Рисунок 9. График амплитудного спектра со сдвигом по времени  По графикам видно, что график амплитудного спектра без сдвига по времени совпадает с графиком амплитудного спектра со сдвигом по времени  3. Равенство Парсеваля: ∑𝑢𝑘2𝑁−1𝑘=0=∑|?̇?𝑛|2𝑁−1𝑛=0   Равенство Парсеваля демонстрирует равенство энергии сигнала во временной области с энергией сигнала в частотной области.  Рисунок 10. Результат работы программы для равенства Парсеваля 7  Вывод 2:  В данном пункте мы изучили свойства дискретного преобразования Фурье, такие как: свойство линейности, свойство задержки (сдвига по времени) и равенство Парсеваля. Мы разобрали физический смысл каждого свойства. Доказали каждое свойство соответствующей программной реализацией.   3.  Произвести декодирование аудио-файла с записью тонального сигнала (Dual-Tone Multi-Frequency (DTMF)) сигнала в формате WAV PCM 16 bit, mono.   Необходимо произвести декодирование аудио файла с записью тонального сигнала DTMF с помощью анализа амплитудного спектра его отсчетов.   Исходный сигнал представляется набором отсчетов, где каждый отсчет является сложения двух синусоид с частотами, которые представлены в таблице 2.1:   Рисунок 11. Таблица частот для кодирования DTMF сигналов.   Затем проводится дискретное преобразование Фурье для каждого отсчета. По полученному амплитудному спектру отсчета проводится поиск частот, используемых в кодировании сигнала. Поиск происходит по нахождению максимума в верхней и нижней группы частот. Максимальное значение в каждой из групп будут достигаться при искомых нами частотах.  Результат работы программы: 8   Рисунок 12. Исходный сигнал 9   Рисунок 13. Вычисление частот и декодирование сообщения Вывод 3:  В данном пункте мы смогли декодировать аудио-файл, применив свои знания о дискретном преобразовании Фурье. Мы рассматривали по 800 семплов, таким образом, получилось проанализировать амплитудный спектр и выполнить задачу декодирования.    10  4. Выполнить оценку смещения между двумя изображениями путем анализа фазового спектра.  Оценивать смещение между двумя изображениями будем на примере изображений формата BMP24, при помощи метода фазовой корреляции (анализируем фазовый спектр). Изображения рассматриваются как массив пикселей RGB. Мы будем рассматривать только один любой цвет (так как изображение черно-белое, цвет не имеет значения). Для данных значений выполняется двойное прямое преобразование Фурье. Далее вычисляется взаимный фазовый спектр: 𝑅= 𝑈1∘𝑈2∗|𝑈1∘𝑈2∗| . Для результата, вычисленного по этой формуле, выполняется обратное преобразование Фурье, которое является фазовой корреляцией. Далее в полученном массиве выполняется поиск максимального значения, координаты которого равны смещению изображения по осям X и Y. Эти X и Y будут координатами пикселя, который мы и искали.  Результат работы программы:  X = 2          Y = 116  Рисунок 14. Склеенное изображение  Вывод 4:  Путем анализа фазового спектра мы выполнили оценку смещения между двумя изображениями. Для этого мы использовали метод фазовой корреляции. После всех преобразований мы нашли координаты искомого пикселя. Исходя из результатов работы программы (см. рис. 14), можно сделать вывод о ее корректности.     Вывод по всей лабораторной работе:  Таким образом, в ходе выполнения данной лабораторной работы, мы научились переводить сигналы из временной области в частотную (получать амплитудный спектр) и обратно, из частотной во временную, по средствам прямого и обратного преобразования 11  Фурье. Узнали о свойствах дискретного преобразования Фурье, таких, как: линейность, задержка (сдвиг по времени), равенство Парсеваля; а также разобрались в их физических смыслах и реализовали их доказательство программно. Поработали с аудио-файлами, научились их расшифровывать. Поработали с изображениями формата BMP, применяя к ним метод фазовой корреляции.    