Цель работы: Изучение методов Фурье-анализа для дискретных и цифровых сигналов. 1. Написать программу вычисления прямого и обратного преобразования Фурье в матричной форме. Дискретное преобразование Фурье является быстрым способом Фурье-анализа, которое можно применить к цифровым сигналам.   Прямое дискретное преобразование Фурье для непрерывной периодической функции вычисляется по формуле: ?̇?𝑘= 1𝑁∑𝑁−1𝑛=0𝑢𝑛𝑒−𝑗2𝜋𝑛𝑁𝑘  (1.1) При добавление нормирующего коэффициента 1𝑁 перед знаком суммы, как правило, применяется при вычислении обратного ДПФ вместо прямого.   Обратное дискретное преобразование Фурье можно вычислить по формуле: 𝑢𝑛=∑𝑁−1𝑘=0?̇?𝑘𝑒𝑗2𝜋𝑛𝑁𝑘  (1.2) Поскольку прямое и обратное дискретное преобразование Фурье можно интерпретировать в терминах операций над векторами, поэтому формулы (1.1) и (1.2) можно представлять в матричной форме:  ?⃗⃗⃗? = ?⃗⃗? 𝐹𝐻  (1.3)  ?⃗? = ?⃗? 𝐹   (1.4)  Где F – матрица N×N, заполненная комплексными экспонентами 𝑒𝑗2𝜋𝑛𝑁𝑘, а 𝐹𝐻 – эрмитово сопряженная матрица с F.    Рис. 1 Матрица F   Результат работы программы: Результат работы программы для функции 𝑢(𝑡)=𝑠𝑖𝑛 (2𝜋𝑓𝑡)  при 𝑓=2 :     Рис. 2. Исходный сигнал  Рис.  3 Прямое дискретное преобразование Фурье  Рис.  4 Обратное ДПФ  Как видно по графикам обратное дискретное преобразование Фурье совпадает с исходным сигналом. Вывод: В данном пункте ознакомились с дискретным преобразованием Фурье. Используя матричное представление формул (1.1) и (1.2) была написана программа для проведения прямого и обратного дискретного преобразования Фурье.  Прямое дискретное преобразование Фурье позволяет нам переводить сигнал из временной области в частотную (см. рисунок 4), а обратное дискретное преобразование позволяет перевести спектр сигнала во временную область (см. рисунок 5). Судя по результатам, представленных на рисунках 1, 2, 3 , можно сделать вывод, что программа работает корректно. 2. Продемонстрировать с помощью написанной программы свойства линейности, сдвига сигнала во времени и равенство Парсеваля. С помощью программы, написанной в первом пункте, необходимо проверить свойства дискретного преобразования Фурье: 1. Линейность: 𝛼1𝑢𝑘(1)+𝛼2𝑢𝑘(2)↔ 𝛼1?̇?𝑛(1)+𝛼2?̇?𝑛(2)                             (2.1)    2. Задержка: 𝑢𝑘−𝜏↔ ?̇?𝑛𝑒−𝑗2𝜋𝑛𝑁𝜏                                                 (2.2)  3. Равенство Парсеваля: ∑𝑁−1𝑘=0𝑢𝑘2=∑𝑁−1𝑛=0|?̇?𝑛|2                                                          (2.3)  Результат работы программы: Для проверки свойства линейности возьмем две функции:  𝑢1(𝑡)=𝑠𝑖𝑛 (2𝜋𝑓1𝑡)  и   𝑢2(𝑡)=𝑠𝑖𝑛 (2𝜋𝑓2𝑡)  Частоты функций: 𝑓1=2 и  𝑓2=3 Коэффициенты: 𝛼1 = 3, 𝛼2 = 5;  Рис. 5 Сигнал  𝛼1⋅ 𝑢1+𝛼2⋅ 𝑢2  Рис. 6 Обратное ДПФ от сигнала  𝛼1⋅ ?̇?1+𝛼2⋅ ?̇?2 Как видно по графикам, результат, полученный после применения обратного дискретного преобразования Фурье, совпадает с суммой исходных сигналов.  Сдвиг во времени: Возьмем сигнал, представленный на рисунке 2, и сдвинем его на t = Pi/2.   Рис. 7 Исходный сигнал (Оранжевый) и сигнал сдвинутый на t (Синий)  Рис. 8 Обратное ДПФ от правой части формулы (2.2)  Как видно по графикам, результат, полученный после применения обратного дискретного преобразования Фурье, совпадает с исходным сдвинутым сигналом.  Равенство Парсеваля: Результаты:  ∑𝑁−1𝑘=0𝑢𝑘2=500  1𝑁∑𝑁−1𝑛=0|?̇?𝑛|2=500  По этим результатам можно судить, что равенство Парсеваля выполнено. Вывод: В данном пункте мы ознакомились со свойствами дискретного преобразования Фурье и продемонстрировали их программно.  3. Произвести декодирование аудио-файла с записью тонального сигнала (Dual-Tone Multi-Frequency (DTMF)) сигнала в формате WAV PCM 16 bit, mono. Необходимо произвести декодирование аудио файла с записью тонального сигнала DTMF с помощью анализа амплитудного спектра его отсчетов.  Исходный сигнал представляется набором отсчетов, где каждый отсчет является сложения двух синусоид с частотами, которые представлены в таблице 2.1:   Рис. 9 Таблица частот для кодирования DTMF сигналов  Затем проводится дискретное преобразование Фурье для каждого отсчета. По полученному амплитудному спектру отсчета проводится поиск частот, используемых в кодировании сигнала. Поиск происходит по нахождению максимума в верхней и нижней группы частот. Максимальное значение в каждой из групп будут достигаться при искомых нами частотах.  Результат работы программы:  Рис. 10 Исходный сигнал  Вычисления: 𝑓1=697,𝑓2=1209 𝑓1=697,𝑓2=1336 𝑓1=697,𝑓2=1209 𝑓1=697,𝑓2=1336 𝑓1=770,𝑓2=1336 𝑓1=770,𝑓2=1477 𝑓1=770,𝑓2=1336 𝑓1=770,𝑓2=1477 𝑓1=852,𝑓2=1477 𝑓1=697,𝑓2=1336  Вывод: В данном пункте мы применили свои знания, полученные нами в пунктах ранее по дискретному преобразованию Фурье (1.3 и 1.4). С помощью ДПФ, мы смогли декодировать исходный аудио-файл (см. рисунок 10), постоянно рассматривая его определённое количество кадров. Таким образом, проанализировав амплитудный спектр сигнала у нас получилось выполнить эту задачу и продемонстрировать работу дискретного преобразования Фурье. 4. Выполнить оценку смещения между двумя изображениями путем анализа фазового спектра. Нужно оценить смещение между двумя изображениями в формате BMP24 с помощью анализа фазового спектра. Для оценки смещения будет применяется метод фазовой корреляции. Изображения представляются как массивы пикселей, каждый из которых состоит из 3 цветов (RGB). Для данных значений выполняется прямое двумерное дискретное преобразование Фурье по формуле (1.2). Далее вычисляется взаимный фазовый спектр: 𝑅= 𝑈1∘𝑈2∗|𝑈1∘𝑈2∗|  (4.1)  Для результата, вычисленного по этой формуле, выполняется обратное преобразование Фурье, которое является фазовой корреляцией. Далее в полученном массиве выполняется поиск максимального значения, координаты которого равны смещению изображения по осям X и Y. Эти X и Y будут координатами пикселя, который мы и искали. Результат работы программы:    Рис. 11 Цельный рисунок Вывод: С помощью анализа фазового спектра по методу фазовой корреляции (4.1) мы смогли оценить смещение между двумя   изображениями. Исходя из результатов работы программы (см. рис. 11) мы можем сказать, что она отработала корректно. Вывод:  В результате данной лабораторной работы, мы научились проводить прямое и обратное дискретные преобразования Фурье, вычислять амплитудные спектры сигналов и анализировать их. Таким образом, при выполнении данной лабораторной работы мы смогли научиться переводить сигналы из временной области в частотную и анализировать их амплитудные, фазовые спектры.  