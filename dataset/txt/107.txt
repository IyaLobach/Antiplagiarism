 2  Цель работы: для выбранного варианта задания разработать и отладить программу моделирования, выполнить моделирование для нескольких значений отношения сигнал/шум, вычислить значения вероятности ошибки или ее верхней границы по соответствующим теоретическим формулам и построить графики.  1. Исходные данные для варианта 8 КАМ  𝑓0=1800 Гц 𝑉𝑚𝑜𝑑=1200 бод 𝑉𝑖𝑛𝑓=7200 бит/с  2. Базис для геометрического представления сигналов КАМ 𝜑1(𝑡)= {√2𝑇cos(2𝜋𝑓0𝑡),0<𝑡<𝑇 0,иначе 𝜑2(𝑡)= {√2𝑇sin(2𝜋𝑓0𝑡),0<𝑡<𝑇 0,иначе  Данные функции образуют базис размерности 𝐷 = 2.  3. Моделирование передачи по каналу и оптимального приема Цель выполнения этого задания состоит в построении программной модели канала с АБГШ и приемника, реализующего алгоритм оптимального приема. В результате моделирования должны быть получены оценки вероятности ошибки приема сигнала для разных отношений сигнал/шум.  Процесс моделирования состоит в многократном выполнении следующих шагов:  – случайный равновероятный выбор номера сигнала 𝑖,подлежащего передаче, 𝑖=0,1,…𝑞−1;  – получение сигнала 𝑟(𝑡) на выходе канала согласно равенству 𝑟(𝑡)=𝑠𝑖(𝑡)+𝑛(𝑡), где 𝑛(𝑡) – АБГШ со спектральной плотностью мощности 𝑁0/2;  – вычисление вектора 𝑟=(𝑟1,𝑟2,…𝑟𝐷) с компонентами 𝑟𝑗(𝑡)= ∫𝑟(𝑡)𝜑𝑗(𝑡)𝑑𝑡𝑇0;  – формирование решения 𝑖̂. Для определения минимального расстояния до 𝑠𝑖, будет вычисляться 𝑑(𝑟,𝑠𝑖)= √∑(𝑟𝑗−𝑠𝑖𝑗)2𝐷𝑗=1.  – фиксации результата: если 𝑖̂ ≠𝑖, то решение на приемной стороне сформировано неправильно и нужно увеличить счетчик числа ошибок.   3  Оценка вероятности ошибки получается путем деления числа произошедших ошибок на число испытаний. При большом числе испытаний эта оценка должна быть близка к истинной вероятности ошибки или к ее верхней границе, которые вычисляются по соответствующим формулам.  Указанные шаги выполняются для нескольких значений отношения сигнал шум, в результате получается зависимость оценки вероятности ошибки, полученной экспериментально, от отношения сигнал/шум. Эта зависимость при правильном выполнении задании должна хорошо соотноситься с теоретической зависимостью вероятности ошибки от отношения сигнал/шум. Формулы для вероятности ошибки от отношения сигнал/шум, определяющие теоретическую зависимость, могут быть, например, найдены в соответствующем разделе пособия [1].  Исходными данными для моделирования являются следующие:  – набор значений отношения сигнал шум 𝛾𝑑𝐵(1),𝛾𝑑𝐵(2),…,𝛾𝑑𝐵(𝑛);  – сигнальное множество {𝑠𝑖(𝑡)},𝑖=0,1,…,𝑞−1;  – функциональный базис {𝜑𝑗(𝑡)},𝑗=1,2,…𝐷;  – описание решающих областей 𝑅𝑖,𝑖=0,1,…,𝑞−1. В результате моделирования должны быть экспериментально получены оценки вероятности ошибки 𝑃𝑒(1),𝑃𝑒(2),…,𝑃𝑒(𝑛), соответствующие значениям отношения сигнал/шум 𝛾𝑑𝐵(1),𝛾𝑑𝐵(2),…,𝛾𝑑𝐵(𝑛).  Верхняя граница ошибки для КАМ:  𝑃𝑒<exp (−3?̅?2(𝑞−1)𝑁0)    4   4. Графики моделирования  График 1 - 𝑌 =7𝑑𝐵   График 2 - Y=21𝑑𝐵   5  Теоретическая и экспериментальная зависимость вероятности ошибки от отношения сигнал-шум при максимальном количестве ошибок 80:   Вывод: в ходе лабораторной работы была промоделирована работа оптимального приёмника дискретных сигналов в канале с белым аддитивным белым гауссовским шумом, был получен сигнал 𝑟(𝑡) на выходе приёмника и вычислен вектор r, а также было произведено формирование решения ?̂? и фиксация результата. Была произведена оценка вероятности ошибки теоретическим и экспериментальным путём.   График 3 - Теоретическая и экспериментальная зависимость вероятности ошибки от отношения сигнал-шум при максимальном количестве ошибок 80  6  Листинг программы:  f0 = 1800; Vmod = 1200; Vinf = 7200; T = 1 / Vmod; m = Vinf * T; q = 2^m; dt = T/1000; t = 0:dt:T; A = 7;   % вычисление сигналов s = zeros(q,length(t)); ii = [7 5 3 1 -1 -3 -5 -7]; for c = 1:q     s(c,:) = (ii(fix((c-1)/8) + 1)*sqrt(2/T).*cos(2*pi*f0*t)) + (ii(mod(c-1,8)+ 1)*sqrt(2/T).*sin(2*pi*f0*t)); end E_sr = sum(s .* s) / (q);     % вычисление координат phi_1 = sqrt(2/T)*cos(2*pi*f0*t); phi_2 = sqrt(2/T)*sin(2*pi*f0*t); sij = zeros(q,2); si1 = zeros(q); si2 = zeros(q); for c = 1:q     sij(c,1) = trapz(t,s(c,: ).*phi_1);     sij(c,2) = trapz(t,s(c,: ).*phi_2); end   % сигнальное создвездие  for c = 1:q     plot(sij(c,1), sij(c,2),'r.','MarkerSize', 15);     hold on; end for n = -6:2:6     line ([n n], [-8 8]);     line ([-8 8], [n n]); end   % моделирование приемника YdB = 1 : 1 : 21; Pe = zeros(1,length(YdB)); Pe_tub = zeros(1, length(YdB)); N_err_max = 100; for n = 1 : length(YdB)      Y = 10 ^ (n / 10);      sigma = sqrt(sum(E_sr / (2 * Y)));         N_err = 0;      N_test = 0;  7       while (N_err < N_err_max)          i = randi(q);          r = s(i,:) + sigma .* randn(1,length(s(i,:)));          r1 = trapz(t,r .* phi_1);          r2 = trapz(t,r .* phi_2);          if (n == length(YdB))              plot(r1, r2, 'b.','MarkerSize', 15);              hold on;          end           min_d = 1000000000;          min_index = -1;          for k = 1:q              d = sqrt((r1 - sij(k,1))^2 + (r2 - sij(k,2))^2);               if (d < min_d)                     min_d = d;                     min_index = k;              end           end          if  i~= min_index             N_err = N_err+ 1;          end          N_test = N_test + 1;      end      Pe(n) = N_err/N_test;      Pe_tub(n) = exp(-3 / (2*(q - 1)) *Y); end   % вероятность ошибки figure(2); semilogy(YdB, Pe_tub, 'black-', YdB, Pe, 'red.-','MarkerSize', 10); legend('Theoretical error','Experimental error'); grid on xlabel('Ydb'); ylabel('P_E');  