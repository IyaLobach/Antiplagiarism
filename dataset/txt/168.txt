Лабораторная работа ЗАПРОСЫ Цель работы Создать по одному запросу каждого вида к данным своей базы данных: на выборку данных однотабличный и многотабличный) с различными условиями для от- бора данных запросы: с параметром запросы на группировку данных запрос на создание вычисляемых полей и датой с временем запрос на создание таблицы перекрестный запрос на добавление одной записи параметрический запрос) на добавление несколько записей на удаление записей на обновление полей записей Ход выполнения работы Имеем уже построенную структуру базы данных: Рисунок Структура таблиц Будем составлять запросы: Однотабличный запрос на выборку данных с различными условиями для отбора данных Исходная таблица Задачи”, из которой будем делать выборку: Рисунок Таблица Задачи” Создадим запрос на выборку задач, которые еще не выполнены: Рисунок Структура запроса на выборку из невыполненных задач Получим искомую выборку: Рисунок Выборка с невыполненными задачами Создадим запрос на выборку с двумя условиями: задачи должны быть выполнены, а дата созда- ния задачи ранее сегодняшней. Рисунок Структура запроса на выборку из выполненных задач, созданных раньше сегодняшней даты Получим искомую выборку: Рисунок Выборка из выполненных задач, созданных раньше сегодняшней даты Создадим запрос на выборку с условием будем выводить сотрудников, оклад кото- рых находится в границах от до рублей. Рисунок Структура запроса на выборку с условием В результате получим выборку: Рисунок Выборка, полученная в результате выполнения запроса с условием Создадим запрос на выборку с условием будем выводить сотрудников, в ФИО которых встречается сочетание букв ма”. Рисунок Структура запроса на выборку с условием В результате получим выборку: Рисунок Выборка, полученная в результате запроса с условием Многотабличный запрос на выборку данных с различными условиями для отбора данных Составим запрос на выборку из двух таблиц. Будем выводить ФИО сотрудника и проект, за кото- рый он ответственен. Сформируем выборку из проектов, которые уже завершены. Рисунок Структура запроса на выборку из завершенных проектов Получили искомую выборку: Рисунок Выборка из завершенных проектов Составим выборку с несколькими условиями: выведем список незавершенных проектов под ру- ководством сотрудников на должности маркетолог”. Рисунок Структура запроса на выборку из незавершенных проектов, за которые ответственен маркетолог Получим искомую выборку: Рисунок Выборка из незавершенных проектов, за которые ответственен маркетолог Составим запрос на выборку с условием выведем список сотрудников, состоящих в отделе разработки приложения. Рисунок Структура запроса на с условием Получим выборку: Рисунок Результат запроса на выборку с условием Запрос с параметром Создадим запрос с параметром Дадлайн”. По запросу будем выводить данные сотрудника и задачи, кото- рые за ним закреплены. При этом задаваемым параметром является дата, к которой задача должна быть выполнена. Рисунок Структура запроса с параметром Рисунок Окно ввода параметра, в котором задается требуемая дата В результате получим ответ на запрос: Рисунок Результат запроса с параметром Запрос на группировку данных Сгруппируем данные: будем выводить ФИО сотрудника и общее количество закрепленных за ним задач. Сформируем запрос: Рисунок Структура запроса на группировку данных В результате получим: Рисунок Результат запроса на группировку данных Запрос на создание вычисляемых полей и датой с временем Создадим запрос на создание вычисляемого поля. В качестве вычисляемого поля будет выступать поле Зарплата в долларах”. Рисунок Структура запроса на создание вычисляемого поля Зарплата в долларах” Рисунок Задаем формулу вычислений в построителе выражений Получим результат запроса: Рисунок Результат запроса на создание вычисляемого поля Зарплата в долларах” Создадим еще один запрос на создание вычисляемого поля. В качестве вычисляемого поля будет выступать поле Год”. Рядом с задачами будем выводить год их создания. Рисунок Структура запроса на создание вычисляемого поля Год” В результате получим: Рисунок Результат запроса на создание вычисляемого поля Год” Запрос на создание таблицы Сформируем запрос на создание таблицы Доска разработчиков”, на которую будут выводиться данные и задачи только разработчиков на должности Рисунок Структура запроса на создание таблицы Рисунок Окно, в котором задается название будущей таблицы В результате получим новую таблицу: Рисунок Результат выполнения запроса на создание таблицы Перекрестный запрос Ответом перекрестного запроса является перекрестная таблица, в которой мы можем задавать зна- чения в строках и в столбцах по своему желанию, а на пересечении строк и столбцов выдавать значение какой-нибудь агрегатной функции. Создадим перекрестную таблицу, в которой будет отражена связь сотрудника с проектом и количество задач, в каждом из проектов, которые ему назначены. Рисунок Структура перекрёстного запроса В результате получим перекрестную таблицу: Рисунок Результат перекрестного запроса Запрос на добавление одной записи Создадим запрос на добавление одной записи в таблицу Отделы”, то есть добавим новый отдел. Рисунок Окно выбора, в какую таблицу будет добавляться запись Рисунок Структура запроса на добавление записи Вводим параметры новой записи: Рисунок Окно ввода параметров записи В результате в таблицу добавится новая запись: Рисунок Результат выполнения запроса на добавление одной записи Запрос на добавление нескольких записей Для формирования запроса на добавление нескольких записей, создадим копию структуры таб- лицы Проекты” и назовем ее Архив проектов”. В эту таблицу будем добавлять уже завершенные проекты. Рисунок Таблица Проекты” Рисунок Создаем таблицу Архив проектов” Рисунок Новая таблица Архив проектов” Создадим запрос на добавление в таблицу Архив проектов” записей из таблицы Проекты”. Рисунок Выбираем, в какую таблицу будем добавлять записи Добавлять будем проекты, статус которых Завершен”. Рисунок Структура запроса на добавление нескольких записей В результате таблица Архив проектов” пополнится несколькими записями: Рисунок Результат выполнения запроса на добавление нескольких записей Запрос на удаление записей Для демонстрации запроса на удаление записей добавим еще одного сотрудника в таблицу Со- трудники”. Его номер по порядку Будем формировать запрос на удаление по номеру сотруд- ника. Рисунок Таблица Сотрудники” Рисунок Структура запроса на удаление Рисунок Окно для ввода номера сотрудника В результате выполнения запроса из таблицы Сотрудники” будут удалены данные о сотруднике под номером Рисунок Результат выполнения запроса на удаление Запрос на обновление полей записей Для демонстрации запроса на обновление полей обновим сотрудникам оклад, повысив его на Рисунок Исходная таблица Сотрудники”, со старыми данными об окладе Сформируем запрос на обновление полей записей: Рисунок Структура запроса на обновление полей В результате получим таблицу Сотрудники” с обновленными данными об окладе: Рисунок Результат выполнения запроса на обновление полей записей Вывод В ходе выполнения лабораторной работы мы познакомились с запросами и научились применять их на практике. С помощью таких запросов мы научились изменять, создавать и уда- лять поля уже существующих таблиц, а также добавлять новые таблицы. Помимо этого, мы научились создавать вычисляемые поля, реализуя их при помощи запро- сов, в которых используются уже записанные в таблицу данные. 