Цель работы Реализовать алгоритм шифрования Предусмотреть возможность работы алгоритма в режиме Исследовать процесс распространения ошибок в реализуемом режиме шифрования, привести пример распространения ошибок. Реализация каждой системы должна работать в двух режимах: шифрования и дешифрования, позволять вводить ключ вручную и генерировать его автоматически. Вычислить коэффициент корреляции для входного и выходного потока алгоритма шифрования, оценить распределение и в выходном потоке. По результатам анализа сделать выводы о качестве реализованной системы шифрования. Алгоритм это блочный шифр, с размером блока и длиной ключа равными бита. Шифр состоит из х раундов и использует шесть битных подключей, генерируемых из основного ключа. Рис.1 алгоритм На начальном этапе открытый текст разбивается на два блока, по бита каждый. Левый и правый блоки складываются по модулю два с битными подключами и соответственно. Затем левая часть остается без изменений, а правая образуется сложением по модулю два с левым блоком. После этого выполняется раунда шифрования на каждом из которых правый блок суммируется по модулю два с подключом раунда а затем полученный результат прогоняется через функцию перестановки Результат перестановки складывается с левой частью текста. После этих операций левый и правый блок меняют местами и полученный результат подается на вход следующего раунда. Последний раунд немного отличается от всех остальных. Левые и правые блоки не меняются местами, как в предыдущих раундах. Вместо этого, правый блок складывается по модулю два с левым блоком и полученный результат возвращается в качестве правой части шифротекста. Левая же часть после раунда остается неизменной и составляет первые бита полученного шифротекста. Рис.2 функция На входе функция получает байта Далее входные байты перемешиваются и проходят через функции или байта полученных после вычисления функций образуют битную выходную последовательность функции Функции и выполняют преобразование битной входной последовательности в битный результат. Функцию можно выразить следующим образом: где циклический сдвиг влево. В то время как функция имеет следующее определение: Расшифровка алгоритма происходит по такому же принципу. Собственно, шифротекст разбивается на левый и правый блок и все операции шифрования выполняются в обратном порядке. Режим обратной связи по выходу Схема шифрования в режиме определяется следующим образом: Рис.3 Схема шифрования в режиме обратной связи по выходу Рис.4 Схема дешифрования в режиме обратной связи по выходу Особенности режима Значение вектора инициализации должно быть уникальным для каждой процедуры шифрования одним ключом. Его необязательно сохранять в секрете и оно может быть передано вместе с шифротекстом. Алгоритм дешифрования в режиме полностью совпадает с алгоритмом шифрования. Функция дешифрования блочного алгоритма не используется в данном режиме, т.к. ключевой поток генерируется только функцией шифрования блока. Режим наглядно демонстрирует одну из проблем потоковых шифров. При использовании одного и того же вектора инициализации для шифрования нескольких сообщений будет сгенерирован одинаковый поток ключей. Предположим, что Р1 и Р2 два разных сообщения для шифрования ключом К. Зашифруем исходные сообщения в режиме и получим два шифротекста С1 и С2, соответственно. Таким образом, будет справедливо следующее тождество: Следовательно, если потенциальному злоумышленнику известна хотя бы одна пара шифрованного и открытого текста, вычисление любых открытых текстов, зашифрованных таким же ключом и с идентичным вектором инициализации, становится тривиальной задачей. Появление коллизии в ключевом потоке или совпадение вектора инициализации и одного из ключевых блоков) приведёт к циклическому повторению ключевой последовательности, что может вызвать нарушение безопасности режима шифрования, как показано в предыдущем пункте. Распространение ошибки в данном режиме не происходит. Изменение одного бита в шифрованном тексте приведет к изменению одного бита при дешифровании. Однако, потеря бита в шифротексте приведет к некорректному дешифрованию всех последующих битов. Пример работы программы: Рис.5 исходное изображение Рис.6 закодированное изображение Рис.7 раскодированное изображение Расчет коэффициента корреляции Изменим в зашифрованном изображении пиксель и заново раскодируем его: Рис.8 искаженное раскодированное изображение Получим, что в результате изменения пикселя, произошла замена других соседних пикселей в блоке, что повлекло некорректное раскодирование. Следовательно, можно говорить о взаимозависимости некоторых бит в данном алгоритме. Данное явление, при котором изменение одной величины влечет за собой изменение другой, называется корреляцией. Коэффициент корреляции между м входным и м выходным битами узла замен вычисляется по формуле: Кроме того, для двоичных векторов верна более простая формула: Вычислим коэффициенты корреляции для следующего блока замен для алгоритма Получим битовые представления всех чисел нашей подстановки: Таблица битовые представления чисел подстановки В этой таблице число нумерация начинается с нуля) переходит в число число переходит в в число в в число переходит в и тд. Теперь, интерпретируя последовательность битов каждого разряда как множество значений случайной величины, вычислим коэффициенты корреляции между последовательностью входящих битов го разряда и последовательностью выходящих битов го разряда, Таблица расчитанные коэффициенты корреляции Мы видим, что биты и группы остаются неизменными, что свидетельствует о взаимозависимости некоторых входных и выходных потоков данного блока. Вывод В ходе данной лабораторной работы был программно воспроизведен алгоритм шифрования Исследован процесс распространения ошибок в реализуемом режиме шифрования, приведен пример распространения ошибок. Был вычислен коэффициент корреляции для входного и выходного потока алгоритма шифрования. Можно выделить достоинства и недостатки алгоритма: Достоинства: простота аппаратной реализации на современной электронной базе. простота программной реализации в силу того, что значительная часть функций поддерживается на аппаратном уровне в современных компьютерах например, сложение по модулю хорошая изученность алгоритмов, построенных на основе сетей Фейстеля. Недостатки: за один раунд шифруется только половина входного блока. Список источников А.Л. Чмора Современная прикладная криптография" Черчхаус. Коды и шифры НИУ ВШЭ Высшая Школа Бизнес-Информатики): Криптографические методы защиты информации. 