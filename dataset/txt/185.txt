Цель Вариант Реализовать алгоритм шифрования предусмотреть возможность работы алгоритма в режиме Исследовать процесс распространения ошибок в реализуемом режиме шифрования, привести пример распространения ошибок. По результатам анализа сделать выводы о качестве реализованных систем шифрования. Вычислить коэффициент корреляции для входного и выходного потока алгоритма шифрования, оценить распределение и в выходном потоке. Описание алгоритма алгоритм битного блочного шифра с ключом переменной длины. Был разработан известным специалистом в области криптографии и защиты информации Брюсом Шнайером в году. В общем случае алгоритм состоит из двух этапов расширение ключа и шифрация/дешифрация исходных данных. Алгоритм шифруется данные битными блоками. Размер ключа алгоритма является переменным от до битов. Алгоритм представляет собой сеть Фейстеля рисунок Шифрование данных выполняется в раундов, в каждом из которых над левым битным субблоком данных производятся следующие действия: Значение субблока складывается с ключом го раунда операцией результат становится новым значением субблока Субблок обрабатывается функцией результат обработки накладывается на правый субблок операцией Субблоки меняются местами во всех раундах, кроме последнего. После раундов выполняется наложение на субблоки еще двух подключей: и складываются операцией с правым и левым субблоками соответственно. Рисунок Структура алгоритма Функция обрабатывает субблок следующим образом рис. Рисунок Функция Расшифровывание выполняется аналогично зашифровыванию, но ключи используются в обратном порядке. Процедура расширение ключа Задача процедуры расширения ключа состоит в вычислении на основе ключа шифрования значений ключей раундов и таблиц замены Для этого используется процедура расширения ключа, состоящая из следующих шагов: Исходные значения ключей раундов и таблиц замен инициализируются фиксированной псевдослучайной строкой, в качестве которой используется шестнадцатеричная запись дробной части числа Операцией на накладываются первые бита ключа шифрования, на следующие бита и т.д. до Если используется более короткий ключ шифрования, то ключ шифрования накладывается циклически С использованием полученных ключей раундов и таблиц замены выполняется шифрования алгоритмом блока данных, состоящего из нулевых битов. Результат становится новым значением ключей и Результат предыдущего этапа снова шифрует алгоритмом причём уже с изменёнными значениями ключей и в результате получаются новые значения ключей и Шифрование выполняется до тех пор, пока новыми значениями не будут заполнены все ключи раундов и таблицы замен. Режим шифрования СFB В режиме й блок шифротекста формируется путем шифрования го блока шифротекста и его суммированием операция с м блоком открытого текста. Шифрование может быть описано следующим образом: Где номер блоков, вектор инициализации, и блоки зашифрованного и открытого текстов соответственно, а функция блочного шифрования. Рисунок Шифрование в режиме СFB Криптостойкость определяется криптостойкостью используемого шифра. Фиксируемые блоки открытого текста маскируются» блоками шифротекста. Скорость шифрования режима с полноблочной обратной связью та же, что и у блочного шифра, причем возможности распараллеливания процедуры шифрования ограничены. Рисунок Дешифрование в режиме СFB Описание реализации На входе программа просит сгенерировать рандомный ключ или задать ключ самостоятельно. Затем программа считывает из файла поблочно данные и шифрует/дешифрует его, в зависимости от того, в каком режиме программа работает на данный момент. После этого, программа выводит в файл шифрованные/дешифрованные данные текст/изображение). Примеры Пример шифрования текста в режиме шифрования. Ключ шифрования: Исходный текст в файле: Рисунок Исходный текст Зашифрованный текст: Рисунок Зашифрованный текст Расшифрованный текст: Рисунок Расшифрованный текст Рисунок Исходное изображение Проведем шифрование, используя режим СFB. Результат шифрования представлен на рисунке Рисунок Зашифрованное изображение Результат дешифрования представлен на рисунке Как можно заметить, он идентичен входному изображению. Рисунок Дешифрованное изображение Если зашифрованный файл будет как-либо повреждён рисунок то и дешифрованный файл будет отличаться от исходного рисунок Рисунок Поврежденное зашифрованное изображение Рисунок Восстановленное изображение Коэффициент корреляции для входного и выходного потока алгоритма шифрования Вычислим коэффициент корреляции для красной компоненты исходного и закодированного изображения. Формула для подсчета коэффициента корреляции представлена ниже: где и компоненты изображения оценка математического ожидания в соответствии с формулой: где А и А оценки среднеквадратичного отклонения компонент А и вычисляемого по формуле: По результатам вычислений, коэффициент корреляции для красной компоненты исходного и закодированного изображения составил Оценка распределения и в выходном потоке Оценим распределение и на примере зашифрованного изображения, представленного на рисунке Вывод Реализован алгоритм шифрования а также режим шифрования Исследован процесс распространения ошибок в реализуемом режиме шифрования. Вычислен коэффициент корреляции. Достоинства алгоритма: Высокая скорость шифрования на развернутом ключе Простота алгоритма, снижающая вероятность ошибок при его реализации Отсутствие известных успешных атак на полнораундовую версию алгоритма. Недостатки алгоритма: Алгоритм не годится для применения в случаях, где требуется частая смена ключей, так как процедура расширения ключа является достаточно ресурсоемкой Невозможность расширения ключа параллельно процессу шифрования Небольшой по современным меркам размер блока шифруемых данных. Список литературы Б. Я. Рябко и А. Н. Фионов, Основы современной криптографии для специалистов информационных технологиях, Москва: Научный мир, С. П. Панасенко, Алгоритмы шифрования. Специальный справочник, Санкт-Петербург: БХВ-Петербург, А.Л. Чмора Современная прикладная криптография, Гелиос 