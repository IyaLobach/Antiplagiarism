2  Лабораторная работа №6 КРИПТОГРАФИЧЕСКИЕ ПРОТОКОЛЫ  1. Описание задания  Реализовать протокол идентификации Feige-Fiat-Shamir.  Требования к работе:  • Разработка двух независимых модулей-участников протокола. • Реализация должна позволять попытки ложной аутентификации. • Количество раундов протокола должно быть параметром схемы. • Отчет должен содержать описание протокола с указанием особенностей реализации, расчеты вероятности ложной идентификации, примеры работы про-граммы. Примечания: • Допускается демонстрация работы алгоритма на маленьких числах (напри-мер, типа int). • Ограничений на язык программирования нет.  2. Описание алгоритма  Протокол Фейга — Фиата — Шамира — протокол идентификации с нуле-вым разглашением, обобщение более раннего протокола Фиата — Шамира, разра-ботанный Уриэлем Фейге , Амосом Фиато и Ади Шамиром в 1986 году.  Протокол позволяет одному участнику (доказывающему A) доказать другому участнику (проверяющему B), что он обладает секретной информацией, не раскры-вая ни единого бита этой информации. Безопасность протокола основана на сложности извлечения квадратного корня по модулю достаточно большого составного числа n, факторизация которого неизвестна. Схема идентификации: A доказывает своё знание секрета s стороне B в течение t раундов, не раскры-вая при этом ни одного бита самого секрета. Выбор параметров системы: Доверенный центр T публикует большое число n=p*q, где p и q — простые числа, которые держатся в секрете. Также выбираются целые числа k и t - параметры безопасности.   3  Генерация секретов для участников: Каждый участник выбирает k случайных целых чисел 𝑠1,𝑠2, ..., 𝑠𝑘,                   1≤ 𝑠𝑖≤𝑛−1 и k случайных бит  𝑏1, 𝑏2, ..., 𝑏𝑘 . Затем вычисляет 𝑣𝑖=(−1)𝑏𝑖∗(𝑠𝑖2)−1 𝑚𝑜𝑑 𝑛,1≤𝑖≤𝑘. Участник идентифицирует себя окружающим с помощью значений (𝑣1, 𝑣2, ..., 𝑣𝑘;𝑛), которые выступают в качестве его открытого ключа, в то время как секретный ключ s = (𝑠1, 𝑠2 , ..., 𝑠𝑘) известен только самому участнику. Действия протокола в рамках одного раунда: 1. A выбирает случайное целое число 𝑟,1≤𝑟≤𝑛−1 и случайный бит b; вычисляет: 𝑥=(−1)𝑏∗𝑟2 𝑚𝑜𝑑 𝑛 и отправляет x стороне B. 2. B отправляет A случайный k-битный вектор (𝑒1, 𝑒2 , ..., 𝑒𝑘), где 𝑒𝑖=0 или   𝑒𝑖=1. 3. A вычисляет и отправляет B:  𝑦=𝑟∗∏𝑠𝑖𝑒𝑖 𝑚𝑜𝑑 𝑛𝑘𝑖=1 4. B вычисляет: 𝑧=𝑦2∗∏𝑣𝑖𝑒𝑖 𝑚𝑜𝑑 𝑛𝑘𝑖=1 и проверяет, что 𝑧=±𝑥 𝑚𝑜𝑑 𝑛.   Рисунок 1. Протокол Фиата-Шамира.   4  Расчет вероятности ложной идентификации: В своих работах Фейге, Фиат и Шамир показали, как параллельная схема мо-жет повысить количество аккредитаций на раунд и уменьшить объем взаимодей-ствия между Пегги и Виктором. Пегги и Виктор повторяют этот протокол t раз, пока Виктор не убедится, что Пегги знает числа (𝑠1, 𝑠2 , ... , 𝑠𝑘). Вероятность, что Пегги удастся обмануть Виктора t раз, равна 12𝑘𝑡 . Авторы рекомендуют использовать вероятность мошенничества 120𝑘𝑡 и предлагают значения k = 5 и t = 4.   3.  Пример работы   Рисунок 2. Пример работы программы №1.  5   Рисунок 3. Пример работы программы №2.   Рисунок 4. Пример работы программы №3. 6   Рисунок 5. Пример работы программы №3.   Рисунок 6. Пример работы программы №3.  4. Источники кода  1) https://github.com/Frilock/feige-fiat-shamir-protocol 2) http://www.dialektika.com/PDF/978-5-9908462-4-1/part.pdf       7  5. Вывод  Если A и B следуют протоколу, то B всегда принимает доказательства. 𝑧=𝑦2∗∏𝑣𝑖𝑒𝑖𝑘𝑖=1=𝑟2∏(𝑠𝑖2𝑒𝑖𝑣𝑖𝑒𝑖)=±𝑘𝑖=1𝑟2=±𝑥 𝑚𝑜𝑑 𝑛 Только одна из миллиона попыток нечестного пользователя обмануть проверяю-щего может увенчаться успехом. Протокол доказывает, что A обладает своим секретным ключом, не раскрывая никакого знания о нём, когда 𝑘=𝑂(loglog𝑛) и 𝑡=𝑂(log𝑛).   